<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Xiyue Zhu" />

<meta name="date" content="2021-12-16" />

<title>zuoye21015</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">zuoye21015</h1>
<h4 class="author">Xiyue Zhu</h4>
<h4 class="date">2021-12-16</h4>



<div id="question" class="section level2">
<h2>Question</h2>
<p>A—21015—2021—09—16<br /> Use knitr to produce at least 3 examples (texts, figures, tables).</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p><br />
texts:利用R语言内置数据集state.x77（其数据意义：美国50个州的八个指标）<br /> 用到的包和函数：<br /> 1. head:输出数据集的前六行。<br /> 2. kable:制作好看的表格。<br /> 3. pheatmap：制作热图。<br /> 4. as.matrix：转化为矩阵 <br /> 5. scale：对数据进行中心化和标准化</p>
<p><br />
tables:为了使表格不过大，可以利用head函数输出state.x77的前六行，再使用kable函数制作出表格。</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(knitr)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;knitr&#39;是用R版本4.1.2 来建造的</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>data1 &lt;-<span class="st"> </span><span class="kw">head</span>(state.x77)</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="kw">kable</span>(data1)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Population</th>
<th align="right">Income</th>
<th align="right">Illiteracy</th>
<th align="right">Life Exp</th>
<th align="right">Murder</th>
<th align="right">HS Grad</th>
<th align="right">Frost</th>
<th align="right">Area</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Alabama</td>
<td align="right">3615</td>
<td align="right">3624</td>
<td align="right">2.1</td>
<td align="right">69.05</td>
<td align="right">15.1</td>
<td align="right">41.3</td>
<td align="right">20</td>
<td align="right">50708</td>
</tr>
<tr class="even">
<td align="left">Alaska</td>
<td align="right">365</td>
<td align="right">6315</td>
<td align="right">1.5</td>
<td align="right">69.31</td>
<td align="right">11.3</td>
<td align="right">66.7</td>
<td align="right">152</td>
<td align="right">566432</td>
</tr>
<tr class="odd">
<td align="left">Arizona</td>
<td align="right">2212</td>
<td align="right">4530</td>
<td align="right">1.8</td>
<td align="right">70.55</td>
<td align="right">7.8</td>
<td align="right">58.1</td>
<td align="right">15</td>
<td align="right">113417</td>
</tr>
<tr class="even">
<td align="left">Arkansas</td>
<td align="right">2110</td>
<td align="right">3378</td>
<td align="right">1.9</td>
<td align="right">70.66</td>
<td align="right">10.1</td>
<td align="right">39.9</td>
<td align="right">65</td>
<td align="right">51945</td>
</tr>
<tr class="odd">
<td align="left">California</td>
<td align="right">21198</td>
<td align="right">5114</td>
<td align="right">1.1</td>
<td align="right">71.71</td>
<td align="right">10.3</td>
<td align="right">62.6</td>
<td align="right">20</td>
<td align="right">156361</td>
</tr>
<tr class="even">
<td align="left">Colorado</td>
<td align="right">2541</td>
<td align="right">4884</td>
<td align="right">0.7</td>
<td align="right">72.06</td>
<td align="right">6.8</td>
<td align="right">63.9</td>
<td align="right">166</td>
<td align="right">103766</td>
</tr>
</tbody>
</table>
<p><br />
figures: 我想要直观的看出这些州的相似性（同时对他们聚类）和指标之间的联系，可以生成每个州和指标的热图。从热图可以很清楚的看出聚类的结果。右边的图例能够说明两者的相关程度，上方Area和Alaska处方块很红，说明相关性很高，但大多数地方颜色偏蓝，呈现出大批量的负相关性。</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">library</span>(pheatmap)</span>
<span id="cb4-2"><a href="#cb4-2"></a>data2 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>((<span class="kw">scale</span>(state.x77)))</span>
<span id="cb4-3"><a href="#cb4-3"></a>p &lt;-<span class="st"> </span><span class="kw">pheatmap</span>(data2,<span class="dt">fontsize=</span><span class="dv">10</span>,<span class="dt">fontsize_row=</span><span class="dv">7</span>,<span class="dt">color=</span><span class="kw">colorRampPalette</span>(<span class="kw">c</span>(<span class="st">&quot;navy&quot;</span>,<span class="st">&quot;white&quot;</span>,<span class="st">&quot;firebrick3&quot;</span>))(<span class="dv">50</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>A—21015—2021—09—23<br /> Exercises 3.4, 3.11, and 3.20 (pages 94-96, Statistical Computating with R)</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<br />
3.4 Rayleigh分布的密度函数为：
<center>
<span class="math inline">\(f(x)=\frac{x}{\sigma^2}e^{-x^2/(2\sigma^2)}\)</span>,
</center>
对其积分，可以得到分布函数
<center>
<span class="math inline">\(F(x)=\int_{0}^{\infty} \frac{x}{\sigma^2}e^{-x^2/(2\sigma^2)}dx=1-e^{-\frac{x^2}{2\sigma^2}}\)</span>，
</center>
<p>对于连续函数，想要产生其随机数，可以使用反函数变换法。<br /> 令<span class="math inline">\(U=F_X(X) \sim Uniform(0,1)\)</span>，则<span class="math inline">\(X=F_X^{-1}(U)=\sqrt{-2\sigma^2\ln(1-U)}\)</span>。<br /> 其产生随机数的具体步骤如下：<br /> step1: 产生均匀分布的随机数<span class="math inline">\(U\)</span>，即<span class="math inline">\(U∼U(0,1)\)</span>；<br /> step2: 利用逆变换产生<span class="math inline">\(X=F_X^{-1}(U)=\sqrt{-2\sigma^2\ln(1-U)}\)</span>；<br /> 我分别选取如下<span class="math inline">\(\sigma\)</span>,产生随机数。</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb5-2"><a href="#cb5-2"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dt">by=</span><span class="fl">0.4</span>)){  </span>
<span id="cb5-4"><a href="#cb5-4"></a>  sigma &lt;-<span class="st"> </span>i</span>
<span id="cb5-5"><a href="#cb5-5"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)  <span class="co">#step1</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>  x1 &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span><span class="st"> </span>sigma<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u)) <span class="co">#step2</span></span>
<span id="cb5-7"><a href="#cb5-7"></a>  t &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,.<span class="dv">01</span>)</span>
<span id="cb5-8"><a href="#cb5-8"></a>  <span class="kw">hist</span>(x1,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="kw">paste</span> (<span class="st">&quot;when i=&quot;</span>, <span class="kw">as.character</span>(i), <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)) <span class="co">#对标题进行修改</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>  <span class="kw">lines</span>(t, t<span class="op">/</span>(sigma<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>t<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>)))</span>
<span id="cb5-10"><a href="#cb5-10"></a>}</span>
<span id="cb5-11"><a href="#cb5-11"></a></span>
<span id="cb5-12"><a href="#cb5-12"></a></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dt">by=</span><span class="dv">4</span>)){</span>
<span id="cb5-14"><a href="#cb5-14"></a>  sigma &lt;-<span class="st"> </span>i</span>
<span id="cb5-15"><a href="#cb5-15"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)  <span class="co">#step1</span></span>
<span id="cb5-16"><a href="#cb5-16"></a>  x2 &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span><span class="st"> </span>sigma<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u)) <span class="co">#step2</span></span>
<span id="cb5-17"><a href="#cb5-17"></a>  t &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,.<span class="dv">01</span>)</span>
<span id="cb5-18"><a href="#cb5-18"></a>  <span class="kw">hist</span>(x2,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="kw">paste</span> (<span class="st">&quot;when i=&quot;</span>, <span class="kw">as.character</span>(i), <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb5-19"><a href="#cb5-19"></a>  <span class="kw">lines</span>(t, t<span class="op">/</span>(sigma<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>t<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>)))</span>
<span id="cb5-20"><a href="#cb5-20"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> <br />我发现，在不同参数下，直方图和理论模型拟合较好。</p>
<p><br />
3.11 题目需要我们生成N(0,1)和N(3,1)的混合分布，并对混合分布的系数做不断变化，视其是否可以改变成双峰。sample函数可以控制p的取值概率。</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>n &lt;-<span class="st"> </span><span class="fl">1e4</span> <span class="co">#生成1000个随机数</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>X1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>) </span>
<span id="cb6-3"><a href="#cb6-3"></a>X2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb6-4"><a href="#cb6-4"></a>p &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="dt">replace=</span><span class="ot">TRUE</span>,<span class="dt">prob=</span><span class="kw">c</span>(<span class="fl">0.25</span>,<span class="fl">0.75</span>)) <span class="co">#控制 p1=0.75 和 p2 = 1 − p1=0.25</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>Z1 &lt;-<span class="st"> </span>p<span class="op">*</span>X1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>p)<span class="op">*</span>X2 <span class="co">#生成混合分布</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="kw">hist</span>(Z1,<span class="dt">prob=</span><span class="ot">TRUE</span>) <span class="co">#做直方图</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><br />
3.20 题目让我们生成一个混合泊松过程，其中<span class="math inline">\(N(t)\)</span>是一个泊松过程，即在时间段<span class="math inline">\(t\)</span>内，服从这样的分布：<span class="math inline">\(P(N_t=n)=\frac{(\lambda t)^n}{n!}e^{-\lambda t}\)</span>，即参数为<span class="math inline">\(\lambda t\)</span>的泊松分布。<span class="math inline">\(Y_i\)</span>是gamma分布，设其服从<span class="math inline">\(GA(\alpha,\beta)\)</span>。<span class="math inline">\(X(t)=\sum_{i=1}^{N(t)}Y_i\)</span>，题目取<span class="math inline">\(t=10\)</span>。模拟10000次，得到均值和方差。<br /></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>out1 &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>){</span>
<span id="cb7-3"><a href="#cb7-3"></a>  t &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>  alpha &lt;-<span class="st"> </span><span class="dv">4</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>  beta &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>  lambda &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>  nt &lt;-<span class="st"> </span><span class="kw">rpois</span>(<span class="dv">1</span>,lambda<span class="op">*</span>t)</span>
<span id="cb7-8"><a href="#cb7-8"></a>  y &lt;-<span class="st"> </span><span class="kw">rgamma</span>(nt,alpha,beta)</span>
<span id="cb7-9"><a href="#cb7-9"></a>  xt&lt;-<span class="st"> </span><span class="kw">sum</span>(y)</span>
<span id="cb7-10"><a href="#cb7-10"></a>  out1[[i]] &lt;-<span class="st"> </span>xt </span>
<span id="cb7-11"><a href="#cb7-11"></a>}</span>
<span id="cb7-12"><a href="#cb7-12"></a>out1 &lt;-<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">unlist</span>(out1))</span>
<span id="cb7-13"><a href="#cb7-13"></a></span>
<span id="cb7-14"><a href="#cb7-14"></a>Ext &lt;-<span class="st"> </span><span class="kw">mean</span>(out1)</span>
<span id="cb7-15"><a href="#cb7-15"></a>Varxt &lt;-<span class="st"> </span><span class="kw">var</span>(out1)</span>
<span id="cb7-16"><a href="#cb7-16"></a>Extl &lt;-<span class="st"> </span>lambda<span class="op">*</span>t<span class="op">*</span>alpha<span class="op">/</span>beta</span>
<span id="cb7-17"><a href="#cb7-17"></a>Varxtl &lt;-<span class="st"> </span>lambda<span class="op">*</span>t<span class="op">*</span>(alpha<span class="op">/</span>beta<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(alpha<span class="op">/</span>beta)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb7-18"><a href="#cb7-18"></a>diffExt &lt;-<span class="st"> </span>Extl<span class="op">-</span>Ext </span>
<span id="cb7-19"><a href="#cb7-19"></a>diffvarxt &lt;-<span class="st"> </span>Varxtl<span class="op">-</span>Varxt </span>
<span id="cb7-20"><a href="#cb7-20"></a><span class="kw">print</span>(diffExt)</span></code></pre></div>
<pre><code>## [1] 0.6527664</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">print</span>(diffvarxt)</span></code></pre></div>
<pre><code>## [1] 5.81818</code></pre>
<p><br />通过多次模拟，可以发现此参数下模拟的均值和方差与理论中的相差很小。<br /></p>
<p><br />下面我随机变换参数，</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>out1 &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>){</span>
<span id="cb11-3"><a href="#cb11-3"></a>  t &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>  alpha &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>  beta &lt;-<span class="st"> </span><span class="dv">6</span></span>
<span id="cb11-6"><a href="#cb11-6"></a>  lambda &lt;-<span class="st"> </span><span class="dv">15</span></span>
<span id="cb11-7"><a href="#cb11-7"></a>  nt &lt;-<span class="st"> </span><span class="kw">rpois</span>(<span class="dv">1</span>,lambda<span class="op">*</span>t)</span>
<span id="cb11-8"><a href="#cb11-8"></a>  y &lt;-<span class="st"> </span><span class="kw">rgamma</span>(nt,alpha,beta)</span>
<span id="cb11-9"><a href="#cb11-9"></a>  xt&lt;-<span class="st"> </span><span class="kw">sum</span>(y)</span>
<span id="cb11-10"><a href="#cb11-10"></a>  out1[[i]] &lt;-<span class="st"> </span>xt </span>
<span id="cb11-11"><a href="#cb11-11"></a>}</span>
<span id="cb11-12"><a href="#cb11-12"></a>out1 &lt;-<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">unlist</span>(out1))</span>
<span id="cb11-13"><a href="#cb11-13"></a></span>
<span id="cb11-14"><a href="#cb11-14"></a>Ext &lt;-<span class="st"> </span><span class="kw">mean</span>(out1)</span>
<span id="cb11-15"><a href="#cb11-15"></a>Varxt &lt;-<span class="st"> </span><span class="kw">var</span>(out1)</span>
<span id="cb11-16"><a href="#cb11-16"></a>Extl &lt;-<span class="st"> </span>lambda<span class="op">*</span>t<span class="op">*</span>alpha<span class="op">/</span>beta</span>
<span id="cb11-17"><a href="#cb11-17"></a>Varxtl &lt;-<span class="st"> </span>lambda<span class="op">*</span>t<span class="op">*</span>(alpha<span class="op">/</span>beta<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(alpha<span class="op">/</span>beta)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb11-18"><a href="#cb11-18"></a>diffExt &lt;-<span class="st"> </span>Extl<span class="op">-</span>Ext </span>
<span id="cb11-19"><a href="#cb11-19"></a>diffvarxt &lt;-<span class="st"> </span>Varxtl<span class="op">-</span>Varxt</span>
<span id="cb11-20"><a href="#cb11-20"></a><span class="kw">print</span>(diffExt)</span></code></pre></div>
<pre><code>## [1] 0.1859208</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">print</span>(diffvarxt)</span></code></pre></div>
<pre><code>## [1] 0.3343366</code></pre>
<p><br />通过多次模拟，可以发现此参数下模拟的均值和方差与理论中的相差很小，但是也不排除某些模拟时，方差相差略大，但是偏差基本不大于1.5。因此，可以认为在不同参数下，模拟的均值和方差与理论中的相差很小，均值模拟表现得更好。<br /></p>
</div>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>A—21015—2021—09—30<br /> Exercises 5.4, 5.9, 5.13, and 5.14 (pages 149-151, Statistical Computing with R).</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<p><br />
5.4 已知<span class="math inline">\(Beta(3,3)\)</span>的分布函数<span class="math inline">\(F(x)=\int_{0}^{x} \frac{1}{Beta(3,3)}t^2(1-t)^2dt=E_{t}[x\frac{1}{Beta(3,3)}t^2(1-t^2)]\)</span>，<br /> 取<span class="math inline">\(g(x)=x\frac{1}{Beta(3,3)}t^2(1-t^2)\)</span>，<span class="math inline">\(t服从U(0,x)\)</span>。<br /> flowchart如下：<br /> 1.从<span class="math inline">\(U(0,x)\)</span>生成独立同分布的<span class="math inline">\(x_1, x_2...,x_m\)</span>，<br /> 2.计算<span class="math inline">\(\overline{g(x)} = \frac{1}{m} \sum_{1}^{m}g(x)\)</span>， <br /> 3.得到<span class="math inline">\(\hat{\theta}=(x-0)\overline{g(x)}。\)</span></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>theta.hat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">9</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a>B &lt;-<span class="st"> </span><span class="kw">beta</span>(<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb15-3"><a href="#cb15-3"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">9</span>,<span class="dt">by=</span><span class="dv">1</span>)){</span>
<span id="cb15-5"><a href="#cb15-5"></a>  y &lt;-<span class="st"> </span><span class="kw">runif</span>(m,<span class="dv">0</span>,t<span class="op">/</span><span class="dv">10</span>)  <span class="co">#t是从0.1-0.9的</span></span>
<span id="cb15-6"><a href="#cb15-6"></a>  theta.hat[t] &lt;-<span class="st"> </span><span class="kw">mean</span>(t<span class="op">/</span><span class="dv">10</span><span class="op">*</span>(y<span class="op">^</span><span class="dv">4-2</span><span class="op">*</span>y<span class="op">^</span><span class="dv">3</span><span class="op">+</span>y<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span>B</span>
<span id="cb15-7"><a href="#cb15-7"></a>}</span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="kw">print</span>(theta.hat)</span></code></pre></div>
<pre><code>## [1] 0.008198896 0.055825037 0.166985107 0.310694521 0.499520136 0.712447706
## [7] 0.832560922 0.965915433 0.968179340</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>t &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>)</span>
<span id="cb17-2"><a href="#cb17-2"></a>p &lt;-<span class="st"> </span><span class="kw">pbeta</span>(t,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb17-3"><a href="#cb17-3"></a>diff &lt;-<span class="st"> </span>theta.hat<span class="op">-</span>p</span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="kw">print</span>(p)</span></code></pre></div>
<pre><code>## [1] 0.00856 0.05792 0.16308 0.31744 0.50000 0.68256 0.83692 0.94208 0.99144</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">print</span>(diff)</span></code></pre></div>
<pre><code>## [1] -0.0003611039 -0.0020949625  0.0039051074 -0.0067454791 -0.0004798640
## [6]  0.0298877060 -0.0043590782  0.0238354332 -0.0232606596</code></pre>
<p>可以发现，两者十分接近。</p>
<p><br />
5.9 瑞利分布积分：<br /> <span class="math inline">\(F(x)=\int_{0}^{x} \frac{t}{\sigma^2}e^{-t^2/(2\sigma^2)}dt=E[x\frac{t}{\sigma^2}e^{-t^2/(2\sigma^2)}]\)</span> <br /> 所以简单的估计量: <br /> <span class="math inline">\(\frac{x+x&#39;}{2}= \frac{1}{m} \sum_{1}^{m} x \frac{u_j}{\sigma^2}e^{-(u_j)^2/(2\sigma^2)}\)</span><br /> 对偶估计量:<br /> <span class="math inline">\(\frac{x_1+x_2}{2}= \frac{1}{m} \sum_{1}^{m/2} \{ x\frac{u_j}{\sigma^2}e^{-(u_j)^2/(2\sigma^2) }+ x\frac{ (x-u_j)}{\sigma^2}e^{-(x-u_j)^2/(2\sigma^2)} \}\)</span><br /> 此处我们取<span class="math inline">\(\sigma=2\)</span>做一下模拟：</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>MC.Phi &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">R =</span> <span class="dv">10000</span>, <span class="dt">antithetic =</span> <span class="ot">TRUE</span>) {</span>
<span id="cb21-2"><a href="#cb21-2"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>,<span class="dv">0</span>,x)</span>
<span id="cb21-3"><a href="#cb21-3"></a>  sigma &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb21-4"><a href="#cb21-4"></a>  <span class="cf">if</span> (<span class="op">!</span>antithetic) v &lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>) <span class="cf">else</span> v &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u</span>
<span id="cb21-5"><a href="#cb21-5"></a>  u &lt;-<span class="st"> </span><span class="kw">c</span>(u, v)</span>
<span id="cb21-6"><a href="#cb21-6"></a>  cdf &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(x))</span>
<span id="cb21-7"><a href="#cb21-7"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(x)) {</span>
<span id="cb21-8"><a href="#cb21-8"></a>    g &lt;-<span class="st"> </span>x[i] <span class="op">*</span><span class="st"> </span>u <span class="op">/</span><span class="st"> </span>(sigma<span class="op">^</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>(u)<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span> <span class="op">/</span>(sigma<span class="op">^</span><span class="dv">2</span>)) </span>
<span id="cb21-9"><a href="#cb21-9"></a>    cdf[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(g) </span>
<span id="cb21-10"><a href="#cb21-10"></a>  }</span>
<span id="cb21-11"><a href="#cb21-11"></a>  cdf</span>
<span id="cb21-12"><a href="#cb21-12"></a>}</span>
<span id="cb21-13"><a href="#cb21-13"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb21-14"><a href="#cb21-14"></a>MC1 &lt;-<span class="st"> </span>MC2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb21-15"><a href="#cb21-15"></a>x &lt;-<span class="st"> </span><span class="fl">1.95</span></span>
<span id="cb21-16"><a href="#cb21-16"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb21-17"><a href="#cb21-17"></a>  MC1[i] &lt;-<span class="st"> </span><span class="kw">MC.Phi</span>(x, <span class="dt">R =</span> <span class="dv">1000</span>, <span class="dt">anti =</span> <span class="ot">FALSE</span>)</span>
<span id="cb21-18"><a href="#cb21-18"></a>  MC2[i] &lt;-<span class="st"> </span><span class="kw">MC.Phi</span>(x, <span class="dt">R =</span> <span class="dv">1000</span>)</span>
<span id="cb21-19"><a href="#cb21-19"></a>}</span>
<span id="cb21-20"><a href="#cb21-20"></a></span>
<span id="cb21-21"><a href="#cb21-21"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">var</span>(MC1),<span class="kw">var</span>(MC2),<span class="kw">var</span>(MC2)<span class="op">/</span><span class="kw">var</span>(MC1)))</span></code></pre></div>
<pre><code>## [1] 2.374013e-05 4.003397e-06 1.686341e-01</code></pre>
<p>可以发现对偶比非对偶的方差减少了很多。</p>
<p><br />
5.13 题目要我们找到两个重要函数与目标函数<span class="math inline">\(g(x)\)</span>接近，我找到的 <br /> <span class="math inline">\(f_1= \frac{xe^{-x^2/2}}{e^{-1/2}}\)</span><br /> <span class="math inline">\(f_2= \frac{x^{-6/5}}{5}\)</span> <br /> 首先我先画出他们对应的图形，以及<span class="math inline">\(g(x)/fi\)</span>，<span class="math inline">\(i=1,2\)</span>的图形，发现他们是比较接近的。</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="fl">.01</span>)</span>
<span id="cb23-2"><a href="#cb23-2"></a>w &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb23-3"><a href="#cb23-3"></a></span>
<span id="cb23-4"><a href="#cb23-4"></a>g &lt;-<span class="st">  </span>x<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi) </span>
<span id="cb23-5"><a href="#cb23-5"></a>f0 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>,<span class="kw">length</span>(x))</span>
<span id="cb23-6"><a href="#cb23-6"></a>f1 &lt;-<span class="st"> </span>x<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">^</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb23-7"><a href="#cb23-7"></a>f2 &lt;-<span class="st"> </span>x<span class="op">^</span>{<span class="op">-</span><span class="dv">6</span><span class="op">/</span><span class="dv">5</span>}<span class="op">/</span><span class="dv">5</span></span>
<span id="cb23-8"><a href="#cb23-8"></a>gs &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">g</span>(x)<span class="op">==</span>x<span class="op">^</span><span class="dv">2</span><span class="op">*</span>e<span class="op">^</span>{<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>}<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)),</span>
<span id="cb23-9"><a href="#cb23-9"></a>        <span class="kw">expression</span>(f[<span class="dv">0</span>](x)<span class="op">==</span><span class="dv">1</span>),</span>
<span id="cb23-10"><a href="#cb23-10"></a>        <span class="kw">expression</span>(f[<span class="dv">1</span>](x)<span class="op">==</span>x<span class="op">*</span>e<span class="op">^</span>{<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>}<span class="op">/</span>e<span class="op">^</span>{<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>}),</span>
<span id="cb23-11"><a href="#cb23-11"></a>        <span class="kw">expression</span>(f[<span class="dv">2</span>](x)<span class="op">==</span>x<span class="op">^</span>{<span class="op">-</span><span class="dv">6</span><span class="op">/</span><span class="dv">5</span>}<span class="op">/</span><span class="dv">5</span>))</span>
<span id="cb23-12"><a href="#cb23-12"></a><span class="co">#for color change lty to col</span></span>
<span id="cb23-13"><a href="#cb23-13"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb23-14"><a href="#cb23-14"></a><span class="co">#figure (a)</span></span>
<span id="cb23-15"><a href="#cb23-15"></a><span class="kw">plot</span>(x, g, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb23-16"><a href="#cb23-16"></a>     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>), <span class="dt">lwd =</span> w,<span class="dt">col=</span><span class="dv">1</span>,<span class="dt">main=</span><span class="st">&#39;(A)&#39;</span>)</span>
<span id="cb23-17"><a href="#cb23-17"></a><span class="kw">lines</span>(x, f0, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">lwd =</span> w,<span class="dt">col=</span><span class="dv">2</span>)</span>
<span id="cb23-18"><a href="#cb23-18"></a><span class="kw">lines</span>(x, f1, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">lwd =</span> w,<span class="dt">col=</span><span class="dv">3</span>)</span>
<span id="cb23-19"><a href="#cb23-19"></a><span class="kw">lines</span>(x, f2, <span class="dt">lty =</span> <span class="dv">4</span>, <span class="dt">lwd =</span> w,<span class="dt">col=</span><span class="dv">4</span>)</span>
<span id="cb23-20"><a href="#cb23-20"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> gs,</span>
<span id="cb23-21"><a href="#cb23-21"></a>       <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">lwd =</span> w, <span class="dt">inset =</span> <span class="fl">0.02</span>,<span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)</span>
<span id="cb23-22"><a href="#cb23-22"></a></span>
<span id="cb23-23"><a href="#cb23-23"></a><span class="co">#figure (b)</span></span>
<span id="cb23-24"><a href="#cb23-24"></a><span class="kw">plot</span>(x, g<span class="op">/</span>f0, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb23-25"><a href="#cb23-25"></a>     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">3.2</span>), <span class="dt">lwd =</span> w, <span class="dt">lty =</span> <span class="dv">2</span>,<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">main=</span><span class="st">&#39;(B)&#39;</span>)</span>
<span id="cb23-26"><a href="#cb23-26"></a><span class="kw">lines</span>(x, g<span class="op">/</span>f1, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">lwd =</span> w,<span class="dt">col=</span><span class="dv">3</span>)</span>
<span id="cb23-27"><a href="#cb23-27"></a><span class="kw">lines</span>(x, g<span class="op">/</span>f2, <span class="dt">lty =</span> <span class="dv">4</span>, <span class="dt">lwd =</span> w,<span class="dt">col=</span><span class="dv">4</span>)</span>
<span id="cb23-28"><a href="#cb23-28"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> gs[<span class="op">-</span><span class="dv">1</span>],</span>
<span id="cb23-29"><a href="#cb23-29"></a>       <span class="dt">lty =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">lwd =</span> w, <span class="dt">inset =</span> <span class="fl">0.02</span>,<span class="dt">col=</span><span class="dv">2</span><span class="op">:</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>接下来，我们来判断在估计<span class="math inline">\(g(x)\)</span>积分时，谁的方差更小。</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw">library</span>(knitr)</span>
<span id="cb24-2"><a href="#cb24-2"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>est &lt;-<span class="st"> </span>sd &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb24-4"><a href="#cb24-4"></a>g &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb24-5"><a href="#cb24-5"></a>  <span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)</span>
<span id="cb24-6"><a href="#cb24-6"></a>}</span>
<span id="cb24-7"><a href="#cb24-7"></a>x &lt;-<span class="st"> </span><span class="kw">runif</span>(m) <span class="co">#using f0</span></span>
<span id="cb24-8"><a href="#cb24-8"></a>fg &lt;-<span class="st"> </span><span class="kw">g</span>(x)</span>
<span id="cb24-9"><a href="#cb24-9"></a>est[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb24-10"><a href="#cb24-10"></a>sd[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</span>
<span id="cb24-11"><a href="#cb24-11"></a></span>
<span id="cb24-12"><a href="#cb24-12"></a>x &lt;-<span class="st"> </span><span class="kw">runif</span>(m) <span class="co">#using f1</span></span>
<span id="cb24-13"><a href="#cb24-13"></a>fg &lt;-<span class="st"> </span><span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span>(x<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">^</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb24-14"><a href="#cb24-14"></a>est[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb24-15"><a href="#cb24-15"></a>sd[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</span>
<span id="cb24-16"><a href="#cb24-16"></a></span>
<span id="cb24-17"><a href="#cb24-17"></a>x &lt;-<span class="st"> </span><span class="kw">runif</span>(m) <span class="co">#using f2</span></span>
<span id="cb24-18"><a href="#cb24-18"></a>fg &lt;-<span class="st"> </span><span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span>(x<span class="op">^</span>(<span class="op">-</span><span class="dv">6</span><span class="op">/</span><span class="dv">5</span>)<span class="op">/</span><span class="dv">5</span>)</span>
<span id="cb24-19"><a href="#cb24-19"></a>est[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb24-20"><a href="#cb24-20"></a>sd[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</span>
<span id="cb24-21"><a href="#cb24-21"></a></span>
<span id="cb24-22"><a href="#cb24-22"></a>res &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="dt">est=</span><span class="kw">round</span>(est,<span class="dv">3</span>), <span class="dt">sd=</span><span class="kw">round</span>(sd,<span class="dv">3</span>))</span>
<span id="cb24-23"><a href="#cb24-23"></a><span class="kw">colnames</span>(res) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;f&#39;</span>,<span class="dv">0</span><span class="op">:</span><span class="dv">2</span>)</span>
<span id="cb24-24"><a href="#cb24-24"></a><span class="kw">kable</span>(res)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">f0</th>
<th align="right">f1</th>
<th align="right">f2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">est</td>
<td align="right">0.102</td>
<td align="right">0.124</td>
<td align="right">0.336</td>
</tr>
<tr class="even">
<td align="left">sd</td>
<td align="right">0.078</td>
<td align="right">0.071</td>
<td align="right">0.360</td>
</tr>
</tbody>
</table>
<p>可以发现<span class="math inline">\(f_1\)</span>的方差比<span class="math inline">\(f_2\)</span>小。</p>
<p><br />
5.14 用5.13中的函数可以估计值，我试图挑选以下更多close的函数（如13中），但是似乎我找到的函数都不能很好的计算出结果，因此我采用另一种importance sampling方法。<br /> 已知<span class="math inline">\(\int_{1}^{\infty} \frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx=\int_{0}^{\infty} \frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx-\int_{0}^{1} \frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx=\frac{1}{2}-\int_{0}^{1} \frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\)</span>，<br /> 找一个函数<span class="math inline">\(f(x)=xe^{-x^2/2}\)</span>，计算<span class="math inline">\(\int_{0}^{1} xe^{-x^2/2}dx=1-\frac{1}{\sqrt{e}}\)</span>，<br /> 因此可以转变原问题为<span class="math inline">\(\frac{1}{2}-\int_{0}^{1} \frac{x}{\sqrt{2\pi}}(1-\frac{1}{\sqrt{e}})\frac{xe^{-x^2/2}}{1-\frac{1}{\sqrt{e}}}dx=\frac{1}{2}-E(\frac{x}{\sqrt{2\pi}}(1-\frac{1}{\sqrt{e}})\)</span>，其中<span class="math inline">\(x\)</span>的密度函数为<span class="math inline">\(\frac{xe^{-x^2/2}}{1-\frac{1}{\sqrt{e}}}\)</span>。<br /> 如何计算<span class="math inline">\(\frac{1}{\sqrt{2\pi}}(1-\frac{1}{\sqrt{e}})E(x)\)</span>，可以利用之前学过的反函数法，令<span class="math inline">\(\int_{0}^{1}\frac{xe^{-x^2/2}}{1-\frac{1}{\sqrt{e}}}dx=\frac{1-e^{-x^2/2}}{1-\frac{1}{\sqrt{e}}}=U\)</span>，则<span class="math inline">\(x=\sqrt{-2ln(1-U+U/\sqrt{e})}\)</span>。</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(n) </span>
<span id="cb25-3"><a href="#cb25-3"></a>x &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u<span class="op">+</span>u<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">exp</span>(<span class="dv">1</span>)))) </span>
<span id="cb25-4"><a href="#cb25-4"></a>theta &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">-</span><span class="kw">mean</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span>(<span class="dv">1-1</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">exp</span>(<span class="dv">1</span>))) <span class="co">#根据原公式计算值</span></span>
<span id="cb25-5"><a href="#cb25-5"></a><span class="kw">print</span>(theta)</span></code></pre></div>
<pre><code>## [1] 0.4008059</code></pre>
</div>
<div id="question-3" class="section level2">
<h2>Question</h2>
<p>A-21015-2021-10-14<br /> Exercises 6.5 and 6.A (page 180-181, Statistical Computing with R) <br /> If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. We want to know if the powers are different at 0.05 level.<br /> 1. What is the corresponding hypothesis test problem?<br /> 2. What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? Why?<br /> 3. Please provide the least necessary information for hypothesis testing. <br /></p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<p><br />
6.5 题目让我们进行均值<span class="math inline">\(t\)</span>检验，服从：<span class="math inline">\(\displaystyle{\frac{\overline{x}-u}{s/\sqrt{n}}} \sim t(n)\)</span>。 <br /> 因此<span class="math inline">\(u=\overline{x} - \displaystyle{\frac{t(n) s}{\sqrt{n}}}\)</span>，其中<span class="math inline">\(x \sim \chi^2(2)\)</span>。<br /></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>s &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb27-3"><a href="#cb27-3"></a>x1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">1000</span>) </span>
<span id="cb27-4"><a href="#cb27-4"></a>x2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">1000</span>) </span>
<span id="cb27-5"><a href="#cb27-5"></a>alpha &lt;-<span class="st"> </span><span class="fl">.05</span> </span>
<span id="cb27-6"><a href="#cb27-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>){</span>
<span id="cb27-7"><a href="#cb27-7"></a>  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dt">df=</span><span class="dv">2</span>)</span>
<span id="cb27-8"><a href="#cb27-8"></a>  x1[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(x)<span class="op">-</span><span class="st"> </span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,<span class="dt">df=</span>n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb27-9"><a href="#cb27-9"></a>  x2[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(x)<span class="op">+</span><span class="st"> </span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,<span class="dt">df=</span>n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(n) </span>
<span id="cb27-10"><a href="#cb27-10"></a>  <span class="cf">if</span> (x1[i] <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span>  <span class="op">&amp;&amp;</span><span class="st"> </span><span class="dv">2</span><span class="op">&lt;</span><span class="st"> </span>x2[i])</span>
<span id="cb27-11"><a href="#cb27-11"></a>  s &lt;-<span class="st"> </span>s<span class="op">+</span><span class="dv">1</span></span>
<span id="cb27-12"><a href="#cb27-12"></a>}</span>
<span id="cb27-13"><a href="#cb27-13"></a><span class="kw">print</span>(s<span class="op">/</span><span class="dv">1000</span>)</span></code></pre></div>
<pre><code>## [1] 0.928</code></pre>
<p>可以发现置信区间并没有非常靠近理论值95%，但相差不大。相比example6.4的推广6.5，x服从正态分布的结果明显好于x服从卡方分布。相比example6.4的推广example6.6，在x服从分布一样的条件下，均值检验的置信区间好于方差的检验。</p>
<p><br />
6.A 题目要解决的问题如下：在样本服从<span class="math inline">\(\chi^2(1)\)</span>，<span class="math inline">\(U(0,2)\)</span>，<span class="math inline">\(exp(1)\)</span>。<br /> 1.是否<span class="math inline">\(t\)</span>检验的empirical Type I error rate = <span class="math inline">\(\alpha\)</span>。<br /> 2.假设检验<span class="math inline">\(H_0: u=u_0\)</span>。<br /> 情况1：<span class="math inline">\(x \sim \chi^2(1)\)</span></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb29-2"><a href="#cb29-2"></a>n &lt;-<span class="st"> </span><span class="dv">100</span> <span class="co">#任意抽取n个样本</span></span>
<span id="cb29-3"><a href="#cb29-3"></a>alpha &lt;-<span class="st"> </span><span class="fl">.05</span></span>
<span id="cb29-4"><a href="#cb29-4"></a>mu0 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co">#经过推导，可以知道卡方的自由度=均值</span></span>
<span id="cb29-5"><a href="#cb29-5"></a></span>
<span id="cb29-6"><a href="#cb29-6"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb29-7"><a href="#cb29-7"></a>p &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) </span>
<span id="cb29-8"><a href="#cb29-8"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb29-9"><a href="#cb29-9"></a>  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df=</span><span class="dv">1</span>)</span>
<span id="cb29-10"><a href="#cb29-10"></a>  ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">mu =</span> mu0) <span class="co">#做检验</span></span>
<span id="cb29-11"><a href="#cb29-11"></a>  p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</span>
<span id="cb29-12"><a href="#cb29-12"></a>}</span>
<span id="cb29-13"><a href="#cb29-13"></a></span>
<span id="cb29-14"><a href="#cb29-14"></a>p.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha)</span>
<span id="cb29-15"><a href="#cb29-15"></a><span class="kw">print</span>(p.hat)</span></code></pre></div>
<pre><code>## [1] 0.062</code></pre>
<p>可以发现<span class="math inline">\(p\)</span>值略大于<span class="math inline">\(\alpha\)</span>，接受原假设。</p>
<p>情况2：<span class="math inline">\(x \sim U(0,2)\)</span></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb31-2"><a href="#cb31-2"></a>n &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb31-3"><a href="#cb31-3"></a>alpha &lt;-<span class="st"> </span><span class="fl">.05</span></span>
<span id="cb31-4"><a href="#cb31-4"></a>mu0 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co">#均匀分布的均值为(a+b)/2</span></span>
<span id="cb31-5"><a href="#cb31-5"></a></span>
<span id="cb31-6"><a href="#cb31-6"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb31-7"><a href="#cb31-7"></a>p &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) </span>
<span id="cb31-8"><a href="#cb31-8"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb31-9"><a href="#cb31-9"></a>  x &lt;-<span class="st"> </span><span class="kw">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb31-10"><a href="#cb31-10"></a>  ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">mu =</span> mu0)</span>
<span id="cb31-11"><a href="#cb31-11"></a>  p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</span>
<span id="cb31-12"><a href="#cb31-12"></a>}</span>
<span id="cb31-13"><a href="#cb31-13"></a></span>
<span id="cb31-14"><a href="#cb31-14"></a>p.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha)</span>
<span id="cb31-15"><a href="#cb31-15"></a><span class="kw">print</span>(p.hat)</span></code></pre></div>
<pre><code>## [1] 0.059</code></pre>
<p>可以发现<span class="math inline">\(p\)</span>略大于<span class="math inline">\(\alpha\)</span>，接受原假设。</p>
<p>情况3：<span class="math inline">\(x \sim exp(1)\)</span></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="kw">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb33-2"><a href="#cb33-2"></a>n &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb33-3"><a href="#cb33-3"></a>alpha &lt;-<span class="st"> </span><span class="fl">.05</span></span>
<span id="cb33-4"><a href="#cb33-4"></a>mu0 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co">#指数分布的均值为1/lambda</span></span>
<span id="cb33-5"><a href="#cb33-5"></a></span>
<span id="cb33-6"><a href="#cb33-6"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb33-7"><a href="#cb33-7"></a>p &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) </span>
<span id="cb33-8"><a href="#cb33-8"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb33-9"><a href="#cb33-9"></a>  x &lt;-<span class="st"> </span><span class="kw">rexp</span>(n, <span class="dv">1</span>)</span>
<span id="cb33-10"><a href="#cb33-10"></a>  ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">mu =</span> mu0)</span>
<span id="cb33-11"><a href="#cb33-11"></a>  p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</span>
<span id="cb33-12"><a href="#cb33-12"></a>}</span>
<span id="cb33-13"><a href="#cb33-13"></a></span>
<span id="cb33-14"><a href="#cb33-14"></a>p.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha)</span>
<span id="cb33-15"><a href="#cb33-15"></a><span class="kw">print</span>(p.hat)</span></code></pre></div>
<pre><code>## [1] 0.068</code></pre>
<p>可以发现<span class="math inline">\(p\)</span>值大于<span class="math inline">\(\alpha\)</span>，应该接受原假设。</p>
<p><br />
问题:If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. We want to know if the powers are different at 0.05 level.<br /> 1. What is the corresponding hypothesis test problem?<br /> 2. What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? Why?<br /> 3. Please provide the least necessary information for hypothesis testing.<br /> 解答：<br /> 1. 对应的假设检验问题是：one method服从<span class="math inline">\(B(n,p_1)\)</span>，another method服从<span class="math inline">\(B(n,p_2)\)</span>，原假设：<span class="math inline">\(p_1=p_2\)</span>，备择假设：<span class="math inline">\(p_1 \neq p_2\)</span>。<br /> 2. 我认为可以用paired-t-test，把<span class="math inline">\(p_1-p_2=0\)</span>视为原假设，<span class="math inline">\(p_1 -p_2 \neq 0\)</span>视为备择假设。<br /> 3. 用paired-t-test最大的问题是数据只有一组，没办法做paired-t-test，可以用两种方法多做几组实验，得到<span class="math inline">\(p_1\)</span>和<span class="math inline">\(p_2\)</span>的更多数据。如果用 two-sample t-test方法，需要验证两样本应近似服从正太分布，且两样本方差也应该近似相等。</p>
</div>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p>A-21015-2021-10-21 Exercises 6.C (pages 182, Statistical Computating with R).</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<p><br />
6.C x是每个元素都服从正态分布的n*d的矩阵，funb1d函数计算了<span class="math inline">\(nb_{1,d}/6\)</span>。example6.8想要我们检验偏度是否为0。</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="kw">library</span>(MASS)</span>
<span id="cb35-2"><a href="#cb35-2"></a>n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>) </span>
<span id="cb35-3"><a href="#cb35-3"></a>m &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb35-4"><a href="#cb35-4"></a>d &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb35-5"><a href="#cb35-5"></a>c &lt;-<span class="st"> </span><span class="kw">qchisq</span>(<span class="fl">0.95</span>, d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</span>
<span id="cb35-6"><a href="#cb35-6"></a>p.reject &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(n))</span>
<span id="cb35-7"><a href="#cb35-7"></a></span>
<span id="cb35-8"><a href="#cb35-8"></a>funb1d &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb35-9"><a href="#cb35-9"></a>  xbar &lt;-<span class="st"> </span><span class="kw">colMeans</span>(x) <span class="co">#每一列的平均值</span></span>
<span id="cb35-10"><a href="#cb35-10"></a>  sigma &lt;-<span class="st"> </span><span class="kw">cov</span>(x)</span>
<span id="cb35-11"><a href="#cb35-11"></a>  b1d &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb35-12"><a href="#cb35-12"></a>  <span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n[i]){</span>
<span id="cb35-13"><a href="#cb35-13"></a>    <span class="cf">for</span> (q <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n[i]){</span>
<span id="cb35-14"><a href="#cb35-14"></a>       b1d &lt;-<span class="st"> </span>b1d <span class="op">+</span>( (x[p,]<span class="op">-</span>xbar) <span class="op">%*%</span><span class="st"> </span><span class="kw">solve</span>(sigma) <span class="op">%*%</span><span class="st"> </span>(x[q,]<span class="op">-</span>xbar)  )<span class="op">^</span><span class="dv">3</span></span>
<span id="cb35-15"><a href="#cb35-15"></a>    }</span>
<span id="cb35-16"><a href="#cb35-16"></a>  }</span>
<span id="cb35-17"><a href="#cb35-17"></a>  b1d &lt;-<span class="st"> </span>b1d<span class="op">/</span>n[i]<span class="op">/</span><span class="dv">6</span></span>
<span id="cb35-18"><a href="#cb35-18"></a>  <span class="kw">return</span>( b1d )</span>
<span id="cb35-19"><a href="#cb35-19"></a>}</span>
<span id="cb35-20"><a href="#cb35-20"></a></span>
<span id="cb35-21"><a href="#cb35-21"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)) {</span>
<span id="cb35-22"><a href="#cb35-22"></a>  test &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) </span>
<span id="cb35-23"><a href="#cb35-23"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb35-24"><a href="#cb35-24"></a>    x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n[i]<span class="op">*</span>d), <span class="dt">nrow =</span> n[i], <span class="dt">ncol =</span> d)</span>
<span id="cb35-25"><a href="#cb35-25"></a>    test[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">funb1d</span>(x) <span class="op">&gt;=</span><span class="st"> </span>c)</span>
<span id="cb35-26"><a href="#cb35-26"></a>  }</span>
<span id="cb35-27"><a href="#cb35-27"></a>  p.reject[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(test)</span>
<span id="cb35-28"><a href="#cb35-28"></a>}</span>
<span id="cb35-29"><a href="#cb35-29"></a></span>
<span id="cb35-30"><a href="#cb35-30"></a>p.reject</span></code></pre></div>
<pre><code>## [1] 0.00 0.02 0.01 0.02</code></pre>
<p>在多次模拟可以看出，应该拒绝原假设，则可以认为偏度不为0。由此此处运行代码需要的时间较长，我截取了<span class="math inline">\(n\)</span>为10, 20, 30, 50。<br /></p>
<p>根据6.10，建立混合分布：<span class="math inline">\((1-\epsilon)N(u=0, \sigma^2=1)+\epsilon N(u=0,\sigma^2=10)\)</span>，并画出经验power曲线。</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>alpha &lt;-<span class="st"> </span><span class="fl">.1</span></span>
<span id="cb37-2"><a href="#cb37-2"></a>n &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb37-3"><a href="#cb37-3"></a>m &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb37-4"><a href="#cb37-4"></a>d &lt;-<span class="dv">3</span> </span>
<span id="cb37-5"><a href="#cb37-5"></a>epsilon &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">0.15</span>, <span class="fl">.01</span>),<span class="kw">seq</span>(<span class="fl">0.15</span>, <span class="dv">1</span>, <span class="fl">.05</span>))</span>
<span id="cb37-6"><a href="#cb37-6"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon)</span>
<span id="cb37-7"><a href="#cb37-7"></a>pw &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb37-8"><a href="#cb37-8"></a>c &lt;-<span class="st"> </span><span class="kw">qchisq</span>(<span class="dv">1</span><span class="op">-</span>alpha, d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</span>
<span id="cb37-9"><a href="#cb37-9"></a></span>
<span id="cb37-10"><a href="#cb37-10"></a>funb1d &lt;-<span class="st"> </span><span class="cf">function</span>(x) { <span class="co">#原本的</span></span>
<span id="cb37-11"><a href="#cb37-11"></a>  xbar &lt;-<span class="st"> </span><span class="kw">colMeans</span>(x) <span class="co">#每一列的平均值</span></span>
<span id="cb37-12"><a href="#cb37-12"></a>  COV &lt;-<span class="st"> </span><span class="kw">cov</span>(x)</span>
<span id="cb37-13"><a href="#cb37-13"></a>  b1d &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb37-14"><a href="#cb37-14"></a>  <span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb37-15"><a href="#cb37-15"></a>    <span class="cf">for</span> (q <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb37-16"><a href="#cb37-16"></a>      b1d &lt;-<span class="st"> </span>b1d <span class="op">+</span>( (x[p,]<span class="op">-</span>xbar) <span class="op">%*%</span><span class="st"> </span><span class="kw">solve</span>(COV) <span class="op">%*%</span><span class="st"> </span>(x[q,]<span class="op">-</span>xbar)  )<span class="op">^</span><span class="dv">3</span></span>
<span id="cb37-17"><a href="#cb37-17"></a>    }</span>
<span id="cb37-18"><a href="#cb37-18"></a>  }</span>
<span id="cb37-19"><a href="#cb37-19"></a>  b1d &lt;-<span class="st"> </span>b1d<span class="op">/</span>n<span class="op">/</span><span class="dv">6</span></span>
<span id="cb37-20"><a href="#cb37-20"></a>  <span class="kw">return</span>(b1d )</span>
<span id="cb37-21"><a href="#cb37-21"></a>}</span>
<span id="cb37-22"><a href="#cb37-22"></a></span>
<span id="cb37-23"><a href="#cb37-23"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb37-24"><a href="#cb37-24"></a>  e &lt;-<span class="st"> </span>epsilon[j]</span>
<span id="cb37-25"><a href="#cb37-25"></a>  test &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb37-26"><a href="#cb37-26"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { </span>
<span id="cb37-27"><a href="#cb37-27"></a>    sigma &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">size =</span> n<span class="op">*</span>d, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</span>
<span id="cb37-28"><a href="#cb37-28"></a>    x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n<span class="op">*</span>d, <span class="dv">0</span>, sigma), <span class="dt">nrow =</span> n, <span class="dt">ncol =</span> d)</span>
<span id="cb37-29"><a href="#cb37-29"></a>    test[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">funb1d</span>(x) <span class="op">&gt;=</span><span class="st"> </span>c)</span>
<span id="cb37-30"><a href="#cb37-30"></a>  }</span>
<span id="cb37-31"><a href="#cb37-31"></a>  pw[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(test)</span>
<span id="cb37-32"><a href="#cb37-32"></a>}</span>
<span id="cb37-33"><a href="#cb37-33"></a></span>
<span id="cb37-34"><a href="#cb37-34"></a><span class="kw">plot</span>(epsilon, pw, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb37-35"><a href="#cb37-35"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pw <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pw) <span class="op">/</span><span class="st"> </span>m) </span>
<span id="cb37-36"><a href="#cb37-36"></a><span class="kw">lines</span>(epsilon, pw<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb37-37"><a href="#cb37-37"></a><span class="kw">lines</span>(epsilon, pw<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> <br />在<span class="math inline">\(0 &lt; ε &lt; 1\)</span>时，最高峰出现在<span class="math inline">\(0.1-0.2\)</span>之间。</p>
</div>
<div id="question-5" class="section level2">
<h2>Question</h2>
<p>A-21015-2021-10-28 Exercises 7.7,7.8,7.9 and 7.B (pages 213, Statistical Computating with R).</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<p><br />
7.7 题目想要我们用bootstrap估计<span class="math inline">\(\hat{\theta}\)</span>的偏差和标准差，其中<span class="math inline">\(\hat{\theta}=\displaystyle{\frac{\hat{\lambda_1}}{\sum_{j=1}^{5}\lambda_j}}\)</span>。<br /></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="kw">library</span>(bootstrap)</span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="kw">library</span>(boot)</span>
<span id="cb38-3"><a href="#cb38-3"></a>lam_hat &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(scor))<span class="op">$</span>values </span>
<span id="cb38-4"><a href="#cb38-4"></a>the_hat &lt;-<span class="st"> </span>lam_hat[<span class="dv">1</span>] <span class="op">/</span><span class="kw">sum</span>(lam_hat) <span class="co">#原本的\theta统计量</span></span>
<span id="cb38-5"><a href="#cb38-5"></a>B &lt;-<span class="st"> </span><span class="dv">50</span></span>
<span id="cb38-6"><a href="#cb38-6"></a></span>
<span id="cb38-7"><a href="#cb38-7"></a>the_b &lt;-<span class="st"> </span><span class="kw">numeric</span>(B)</span>
<span id="cb38-8"><a href="#cb38-8"></a>func &lt;-<span class="st"> </span><span class="cf">function</span>(dat,d){</span>
<span id="cb38-9"><a href="#cb38-9"></a>     x &lt;-<span class="st"> </span>dat[d,]</span>
<span id="cb38-10"><a href="#cb38-10"></a>     lam &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(scor[x,]))<span class="op">$</span>values</span>
<span id="cb38-11"><a href="#cb38-11"></a>     the &lt;-<span class="st"> </span>lam[<span class="dv">1</span>] <span class="op">/</span><span class="kw">sum</span>(lam)</span>
<span id="cb38-12"><a href="#cb38-12"></a>     <span class="kw">return</span>(the)</span>
<span id="cb38-13"><a href="#cb38-13"></a>}</span>
<span id="cb38-14"><a href="#cb38-14"></a></span>
<span id="cb38-15"><a href="#cb38-15"></a>result &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> <span class="kw">cbind</span>(scor<span class="op">$</span>mec,scor<span class="op">$</span>vec,scor<span class="op">$</span>alg,scor<span class="op">$</span>ana,scor<span class="op">$</span>sta),<span class="dt">statistic =</span> func,<span class="dt">R=</span>B)</span>
<span id="cb38-16"><a href="#cb38-16"></a></span>
<span id="cb38-17"><a href="#cb38-17"></a>the_b &lt;-<span class="st"> </span>result<span class="op">$</span>t</span>
<span id="cb38-18"><a href="#cb38-18"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">bias_boot=</span><span class="kw">mean</span>(the_b)<span class="op">-</span>the_hat,<span class="dt">se_boot=</span><span class="kw">sqrt</span>(<span class="kw">var</span>(the_b))),<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## bias_boot   se_boot 
##  -0.27421   0.01871</code></pre>
<p><br />
7.8 题目想要我们用jackknife估计<span class="math inline">\(\hat{\theta}\)</span>的偏差和标准差。<br /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor)</span>
<span id="cb40-2"><a href="#cb40-2"></a>the_j &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb40-3"><a href="#cb40-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb40-4"><a href="#cb40-4"></a>  x &lt;-<span class="st"> </span>scor[<span class="op">-</span>i,]</span>
<span id="cb40-5"><a href="#cb40-5"></a>  lam &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(x))<span class="op">$</span>values</span>
<span id="cb40-6"><a href="#cb40-6"></a>  the_j[i] &lt;-<span class="st"> </span>lam[<span class="dv">1</span>] <span class="op">/</span><span class="kw">sum</span>(lam)</span>
<span id="cb40-7"><a href="#cb40-7"></a>}</span>
<span id="cb40-8"><a href="#cb40-8"></a>bias_jack &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(the_j)<span class="op">-</span>the_hat)</span>
<span id="cb40-9"><a href="#cb40-9"></a>se_jack &lt;-<span class="st">  </span>(n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sqrt</span>(<span class="kw">var</span>(the_j)<span class="op">/</span>n)</span>
<span id="cb40-10"><a href="#cb40-10"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">bias_jack=</span>(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(the_j)<span class="op">-</span>the_hat),<span class="dt">se_jack=</span>(n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sqrt</span>(<span class="kw">var</span>(the_j)<span class="op">/</span>n)),<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## bias_jack   se_jack 
##   0.00107   0.04955</code></pre>
<p><br />
7.9 题目想要我们算出<span class="math inline">\(\hat{\theta}\)</span>的95%的分位数和BCa置信区间。</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="kw">boot.ci</span>(<span class="dt">boot.out =</span> result, <span class="dt">conf =</span> <span class="fl">0.95</span>, <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span></code></pre></div>
<p><br />
7.B 题目想要我们算出正态分布时样本偏度的三种覆盖率。<br /></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>mu&lt;-<span class="dv">0</span>;n&lt;-<span class="dv">100</span>;m&lt;-<span class="fl">1e3</span></span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="kw">library</span>(boot)</span>
<span id="cb43-3"><a href="#cb43-3"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb43-4"><a href="#cb43-4"></a>func &lt;-<span class="st"> </span><span class="cf">function</span>(x,i){</span>
<span id="cb43-5"><a href="#cb43-5"></a>  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x[i])</span>
<span id="cb43-6"><a href="#cb43-6"></a>  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb43-7"><a href="#cb43-7"></a>  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb43-8"><a href="#cb43-8"></a>  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</span>
<span id="cb43-9"><a href="#cb43-9"></a>}</span>
<span id="cb43-10"><a href="#cb43-10"></a>ci.norm&lt;-ci.basic&lt;-ci.perc&lt;-ci.bca&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb43-11"><a href="#cb43-11"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb43-12"><a href="#cb43-12"></a>  x &lt;-<span class="kw">rnorm</span>(n)</span>
<span id="cb43-13"><a href="#cb43-13"></a>  de &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>x,<span class="dt">statistic=</span>func, <span class="dt">R =</span> <span class="dv">999</span>)</span>
<span id="cb43-14"><a href="#cb43-14"></a>  ci &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(de,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb43-15"><a href="#cb43-15"></a>  ci.norm[i,]&lt;-ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>];ci.basic[i,]&lt;-ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb43-16"><a href="#cb43-16"></a>  ci.perc[i,]&lt;-ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb43-17"><a href="#cb43-17"></a>}</span>
<span id="cb43-18"><a href="#cb43-18"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">norm =</span> <span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu <span class="op">&amp;</span><span class="st"> </span>ci.norm[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu),<span class="dt">basic =</span> <span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu <span class="op">&amp;</span><span class="st"> </span>ci.basic[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu),<span class="dt">perc =</span><span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu <span class="op">&amp;</span><span class="st"> </span>ci.perc[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu),<span class="dt">right.norm =</span> <span class="kw">sum</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&gt;=</span>mu)<span class="op">/</span>m,<span class="dt">left.norm =</span> <span class="kw">sum</span>(ci.norm[,<span class="dv">2</span>]<span class="op">&lt;=</span>mu)<span class="op">/</span>m,<span class="dt">right.basic =</span> <span class="kw">sum</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&gt;=</span>mu)<span class="op">/</span>m,<span class="dt">left.basic =</span> <span class="kw">sum</span>(ci.basic[,<span class="dv">2</span>]<span class="op">&lt;=</span>mu)<span class="op">/</span>m,<span class="dt">right.perc =</span> <span class="kw">sum</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&gt;=</span>mu)<span class="op">/</span>m,<span class="dt">left.perc=</span> <span class="kw">sum</span>(ci.perc[,<span class="dv">2</span>]<span class="op">&lt;=</span>mu)<span class="op">/</span>m ),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##        norm       basic        perc  right.norm   left.norm right.basic 
##       0.982       0.981       0.991       0.005       0.013       0.005 
##  left.basic  right.perc   left.perc 
##       0.014       0.003       0.006</code></pre>
<p>题目要求我们算出卡方分布的样本偏度的三种覆盖率。<br /> 由于<span class="math inline">\(var(\chi^2(5))=10\)</span>，<span class="math inline">\(\chi^2(5)=GA(5/2,1/2)\)</span>， 算出<span class="math inline">\(\chi^2(5)\)</span>的理论偏度：<span class="math inline">\(b=v_3/\sigma^3\)</span>，<span class="math inline">\(v_3 = 2\alpha/\lambda^{3}\)</span>，<span class="math inline">\(\sigma^3 = (\sigma^2)^{1.5} =(10)^{1.5}\)</span>。</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>b &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="dv">5</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">^</span><span class="dv">3</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">10</span>)<span class="op">^</span>{<span class="fl">1.5</span>}  </span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="kw">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb45-3"><a href="#cb45-3"></a>n&lt;-<span class="dv">100</span></span>
<span id="cb45-4"><a href="#cb45-4"></a>m&lt;-<span class="fl">1e3</span></span>
<span id="cb45-5"><a href="#cb45-5"></a><span class="kw">library</span>(boot)</span>
<span id="cb45-6"><a href="#cb45-6"></a>func &lt;-<span class="st"> </span><span class="cf">function</span>(x,i){</span>
<span id="cb45-7"><a href="#cb45-7"></a>  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x[i])</span>
<span id="cb45-8"><a href="#cb45-8"></a>  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb45-9"><a href="#cb45-9"></a>  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb45-10"><a href="#cb45-10"></a>  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</span>
<span id="cb45-11"><a href="#cb45-11"></a>}</span>
<span id="cb45-12"><a href="#cb45-12"></a>ci.norm&lt;-ci.basic&lt;-ci.perc&lt;-ci.bca&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb45-13"><a href="#cb45-13"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb45-14"><a href="#cb45-14"></a>  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dv">5</span>)</span>
<span id="cb45-15"><a href="#cb45-15"></a>  de &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>x,<span class="dt">statistic=</span>func, <span class="dt">R =</span> <span class="dv">999</span>)</span>
<span id="cb45-16"><a href="#cb45-16"></a>  ci &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(de,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb45-17"><a href="#cb45-17"></a>  ci.norm[i,]&lt;-ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>];ci.basic[i,]&lt;-ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb45-18"><a href="#cb45-18"></a>  ci.perc[i,]&lt;-ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb45-19"><a href="#cb45-19"></a>}</span>
<span id="cb45-20"><a href="#cb45-20"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">norm =</span> <span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&lt;=</span>b <span class="op">&amp;</span><span class="st"> </span>ci.norm[,<span class="dv">2</span>]<span class="op">&gt;=</span>b),<span class="dt">basic =</span> <span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&lt;=</span>b <span class="op">&amp;</span><span class="st"> </span>ci.basic[,<span class="dv">2</span>]<span class="op">&gt;=</span>b),<span class="dt">perc =</span><span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&lt;=</span>b <span class="op">&amp;</span><span class="st"> </span>ci.perc[,<span class="dv">2</span>]<span class="op">&gt;=</span>b),<span class="dt">right.norm =</span> <span class="kw">sum</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&gt;=</span>b)<span class="op">/</span>m,<span class="dt">left.norm =</span> <span class="kw">sum</span>(ci.norm[,<span class="dv">2</span>]<span class="op">&lt;=</span>b)<span class="op">/</span>m,<span class="dt">right.basic =</span> <span class="kw">sum</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&gt;=</span>b)<span class="op">/</span>m,<span class="dt">left.basic =</span> <span class="kw">sum</span>(ci.basic[,<span class="dv">2</span>]<span class="op">&lt;=</span>b)<span class="op">/</span>m,<span class="dt">right.perc =</span> <span class="kw">sum</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&gt;=</span>b)<span class="op">/</span>m,<span class="dt">left.perc=</span> <span class="kw">sum</span>(ci.perc[,<span class="dv">2</span>]<span class="op">&lt;=</span>b)<span class="op">/</span>m ),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##        norm       basic        perc  right.norm   left.norm right.basic 
##       0.864       0.856       0.852       0.060       0.076       0.087 
##  left.basic  right.perc   left.perc 
##       0.057       0.036       0.112</code></pre>
</div>
<div id="question-6" class="section level2">
<h2>Question</h2>
<p>A-21015-2021-11-04 1. Exercise 8.2 (page 242, Statistical Computating with R).<br /> 2. Design experiments for evaluating the performance of the NN,energy, and ball methods in various situations.<br /> Unequal variances and equal expectations<br /> Unequal variances and unequal expectations<br /> Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)<br /> Unbalanced samples (say, 1 case versus 10 controls)<br /> Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8)<br /></p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<p><br />
8.2 利用双变量Spearman秩相关独立检验作为permutation test。用“Spearman”方法从函数cor中得到Spearman秩相关检验统计量。将permutation test的显著性水平与cor.test的p值在相同样本上进行比较。<br /></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a>v1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0.2</span>, <span class="fl">0.25</span>, <span class="fl">0.3</span>, <span class="fl">0.35</span>, <span class="fl">0.4</span>, <span class="fl">0.45</span>, <span class="fl">0.5</span>, <span class="fl">0.55</span>)  <span class="co">#随意选取的数据</span></span>
<span id="cb47-2"><a href="#cb47-2"></a>v2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">0.95</span>, <span class="fl">0.95</span>, <span class="fl">0.9</span>, <span class="fl">0.85</span>, <span class="fl">0.7</span>, <span class="fl">0.65</span>, <span class="fl">0.6</span>, <span class="fl">0.55</span>, <span class="fl">0.42</span>)</span>
<span id="cb47-3"><a href="#cb47-3"></a>m &lt;-<span class="st"> </span><span class="kw">cor.test</span>(v1, v2, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>, <span class="dt">exact =</span> <span class="ot">FALSE</span>)  <span class="co">#m为cor.test检验的结果</span></span>
<span id="cb47-4"><a href="#cb47-4"></a></span>
<span id="cb47-5"><a href="#cb47-5"></a>R &lt;-<span class="st"> </span><span class="dv">999</span></span>
<span id="cb47-6"><a href="#cb47-6"></a>v &lt;-<span class="st"> </span><span class="kw">c</span>(v1,v2)</span>
<span id="cb47-7"><a href="#cb47-7"></a>K &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">20</span></span>
<span id="cb47-8"><a href="#cb47-8"></a>n &lt;-<span class="st"> </span><span class="kw">length</span>(v1)</span>
<span id="cb47-9"><a href="#cb47-9"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb47-10"><a href="#cb47-10"></a>reps &lt;-<span class="st"> </span><span class="kw">numeric</span>(R)</span>
<span id="cb47-11"><a href="#cb47-11"></a>t0 &lt;-<span class="st"> </span><span class="kw">cor</span>(v1,v2,<span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb47-12"><a href="#cb47-12"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R){                                        <span class="co">#做permutation test</span></span>
<span id="cb47-13"><a href="#cb47-13"></a>  k &lt;-<span class="st"> </span><span class="kw">sample</span>(K,<span class="dt">size=</span>n,<span class="dt">replace=</span><span class="ot">FALSE</span>)</span>
<span id="cb47-14"><a href="#cb47-14"></a>  x1 &lt;-<span class="st"> </span>v[k]</span>
<span id="cb47-15"><a href="#cb47-15"></a>  y1 &lt;-<span class="st"> </span>v[<span class="op">-</span>k]</span>
<span id="cb47-16"><a href="#cb47-16"></a>  reps[i] &lt;-<span class="st"> </span><span class="kw">cor</span>(x1,y1,<span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb47-17"><a href="#cb47-17"></a>}</span>
<span id="cb47-18"><a href="#cb47-18"></a>p &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">abs</span>(<span class="kw">c</span>(t0,reps)) <span class="op">&gt;=</span><span class="st"> </span><span class="kw">abs</span>(t0))</span>
<span id="cb47-19"><a href="#cb47-19"></a><span class="kw">round</span>(<span class="kw">c</span>(p,m<span class="op">$</span>p.value),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.001 0.000</code></pre>
<p>可以看出这两组数据是完全不相关的。</p>
<p><br />
Design experiments for evaluating the performance of the NN,energy, and ball methods in various situations.<br /> 1. Unequal variances and equal expectations<br /></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="kw">library</span>(RANN)</span>
<span id="cb49-2"><a href="#cb49-2"></a><span class="kw">library</span>(boot)</span>
<span id="cb49-3"><a href="#cb49-3"></a><span class="kw">library</span>(Ball)</span>
<span id="cb49-4"><a href="#cb49-4"></a><span class="kw">library</span>(energy)</span>
<span id="cb49-5"><a href="#cb49-5"></a>m &lt;-<span class="st"> </span><span class="dv">100</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>; <span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb49-6"><a href="#cb49-6"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">50</span>; R&lt;-<span class="dv">999</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb49-7"><a href="#cb49-7"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb49-8"><a href="#cb49-8"></a>  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb49-9"><a href="#cb49-9"></a>  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb49-10"><a href="#cb49-10"></a>  z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb49-11"><a href="#cb49-11"></a>  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what&#39;s the first column?</span></span>
<span id="cb49-12"><a href="#cb49-12"></a>  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>] </span>
<span id="cb49-13"><a href="#cb49-13"></a>  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>] </span>
<span id="cb49-14"><a href="#cb49-14"></a>  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>) </span>
<span id="cb49-15"><a href="#cb49-15"></a>  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb49-16"><a href="#cb49-16"></a>}</span>
<span id="cb49-17"><a href="#cb49-17"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb49-18"><a href="#cb49-18"></a>  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,<span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb49-19"><a href="#cb49-19"></a>  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb49-20"><a href="#cb49-20"></a>  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb49-21"><a href="#cb49-21"></a>  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb49-22"><a href="#cb49-22"></a>}</span>
<span id="cb49-23"><a href="#cb49-23"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb49-24"><a href="#cb49-24"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb49-25"><a href="#cb49-25"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb49-26"><a href="#cb49-26"></a>  y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="dv">0</span>,<span class="fl">1.5</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb49-27"><a href="#cb49-27"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb49-28"><a href="#cb49-28"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb49-29"><a href="#cb49-29"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb49-30"><a href="#cb49-30"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb49-31"><a href="#cb49-31"></a>}</span>
<span id="cb49-32"><a href="#cb49-32"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span><span class="fl">0.1</span>) <span class="co">#alpha &lt;- 0.1 </span></span>
<span id="cb49-33"><a href="#cb49-33"></a><span class="kw">print</span>(pow)</span></code></pre></div>
<pre><code>## [1] 0.44 0.67 0.96</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Unequal variances and unequal expectations<br /></li>
</ol>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>m &lt;-<span class="st"> </span><span class="dv">100</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>; <span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb51-2"><a href="#cb51-2"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">50</span>; R&lt;-<span class="dv">999</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb51-3"><a href="#cb51-3"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb51-4"><a href="#cb51-4"></a>  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb51-5"><a href="#cb51-5"></a>  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb51-6"><a href="#cb51-6"></a>  z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb51-7"><a href="#cb51-7"></a>  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what&#39;s the first column?</span></span>
<span id="cb51-8"><a href="#cb51-8"></a>  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>] </span>
<span id="cb51-9"><a href="#cb51-9"></a>  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>] </span>
<span id="cb51-10"><a href="#cb51-10"></a>  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>) </span>
<span id="cb51-11"><a href="#cb51-11"></a>  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb51-12"><a href="#cb51-12"></a>}</span>
<span id="cb51-13"><a href="#cb51-13"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb51-14"><a href="#cb51-14"></a>  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,<span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb51-15"><a href="#cb51-15"></a>  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb51-16"><a href="#cb51-16"></a>  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb51-17"><a href="#cb51-17"></a>  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb51-18"><a href="#cb51-18"></a>}</span>
<span id="cb51-19"><a href="#cb51-19"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb51-20"><a href="#cb51-20"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb51-21"><a href="#cb51-21"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb51-22"><a href="#cb51-22"></a>  y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="fl">1.3</span>,<span class="fl">1.5</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb51-23"><a href="#cb51-23"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb51-24"><a href="#cb51-24"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb51-25"><a href="#cb51-25"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb51-26"><a href="#cb51-26"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb51-27"><a href="#cb51-27"></a>}</span>
<span id="cb51-28"><a href="#cb51-28"></a></span>
<span id="cb51-29"><a href="#cb51-29"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>; </span>
<span id="cb51-30"><a href="#cb51-30"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb51-31"><a href="#cb51-31"></a><span class="kw">print</span>(pow)</span></code></pre></div>
<pre><code>## [1] 0.51 0.81 0.98</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)<br /></li>
</ol>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>m &lt;-<span class="st"> </span><span class="dv">100</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>; <span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb53-2"><a href="#cb53-2"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">50</span>; R&lt;-<span class="dv">999</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb53-3"><a href="#cb53-3"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb53-4"><a href="#cb53-4"></a>  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb53-5"><a href="#cb53-5"></a>  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb53-6"><a href="#cb53-6"></a>  z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb53-7"><a href="#cb53-7"></a>  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what&#39;s the first column?</span></span>
<span id="cb53-8"><a href="#cb53-8"></a>  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>] </span>
<span id="cb53-9"><a href="#cb53-9"></a>  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>] </span>
<span id="cb53-10"><a href="#cb53-10"></a>  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>) </span>
<span id="cb53-11"><a href="#cb53-11"></a>  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb53-12"><a href="#cb53-12"></a>}</span>
<span id="cb53-13"><a href="#cb53-13"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb53-14"><a href="#cb53-14"></a>  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,<span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb53-15"><a href="#cb53-15"></a>  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb53-16"><a href="#cb53-16"></a>  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb53-17"><a href="#cb53-17"></a>  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb53-18"><a href="#cb53-18"></a>}</span>
<span id="cb53-19"><a href="#cb53-19"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb53-20"><a href="#cb53-20"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb53-21"><a href="#cb53-21"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rt</span>(n1<span class="op">*</span>p,<span class="dv">1</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb53-22"><a href="#cb53-22"></a>  m1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="dv">0</span>,<span class="dv">1</span>) </span>
<span id="cb53-23"><a href="#cb53-23"></a>  m2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="dv">3</span>,<span class="dv">10</span>)</span>
<span id="cb53-24"><a href="#cb53-24"></a>  y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="fl">0.75</span><span class="op">*</span>m1<span class="fl">+0.25</span><span class="op">*</span>m2 ,<span class="dt">ncol=</span>p);</span>
<span id="cb53-25"><a href="#cb53-25"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb53-26"><a href="#cb53-26"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb53-27"><a href="#cb53-27"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb53-28"><a href="#cb53-28"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb53-29"><a href="#cb53-29"></a>}</span>
<span id="cb53-30"><a href="#cb53-30"></a></span>
<span id="cb53-31"><a href="#cb53-31"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>; </span>
<span id="cb53-32"><a href="#cb53-32"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb53-33"><a href="#cb53-33"></a><span class="kw">print</span>(pow)</span></code></pre></div>
<pre><code>## [1] 0.85 0.90 0.93</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Unbalanced samples (say, 1 case versus 10 controls)<br /> Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8)<br /></li>
</ol>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a>m &lt;-<span class="st"> </span><span class="dv">100</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>; <span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb55-2"><a href="#cb55-2"></a>n1 &lt;-<span class="st"> </span><span class="dv">4</span>; n2 &lt;-<span class="st"> </span><span class="dv">100</span>; R&lt;-<span class="dv">999</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb55-3"><a href="#cb55-3"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb55-4"><a href="#cb55-4"></a>  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb55-5"><a href="#cb55-5"></a>  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb55-6"><a href="#cb55-6"></a>  z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb55-7"><a href="#cb55-7"></a>  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what&#39;s the first column?</span></span>
<span id="cb55-8"><a href="#cb55-8"></a>  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>] </span>
<span id="cb55-9"><a href="#cb55-9"></a>  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>] </span>
<span id="cb55-10"><a href="#cb55-10"></a>  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>) </span>
<span id="cb55-11"><a href="#cb55-11"></a>  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb55-12"><a href="#cb55-12"></a>}</span>
<span id="cb55-13"><a href="#cb55-13"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb55-14"><a href="#cb55-14"></a>  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,<span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb55-15"><a href="#cb55-15"></a>  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb55-16"><a href="#cb55-16"></a>  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb55-17"><a href="#cb55-17"></a>  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb55-18"><a href="#cb55-18"></a>}</span>
<span id="cb55-19"><a href="#cb55-19"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb55-20"><a href="#cb55-20"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb55-21"><a href="#cb55-21"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb55-22"><a href="#cb55-22"></a>  y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="fl">1.5</span>,<span class="fl">1.5</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb55-23"><a href="#cb55-23"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb55-24"><a href="#cb55-24"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb55-25"><a href="#cb55-25"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb55-26"><a href="#cb55-26"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb55-27"><a href="#cb55-27"></a>}</span>
<span id="cb55-28"><a href="#cb55-28"></a></span>
<span id="cb55-29"><a href="#cb55-29"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>; </span>
<span id="cb55-30"><a href="#cb55-30"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb55-31"><a href="#cb55-31"></a><span class="kw">print</span>(pow)</span></code></pre></div>
<pre><code>## [1] 0.28 0.86 0.81</code></pre>
</div>
<div id="question-7" class="section level2">
<h2>Question</h2>
<p>A-21015-2021-11-11 1. Exercies 9.3 and 9.8 (pages 277-278, Statistical Computating with R)<br /> 2. For each of the above exercise, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to Rˆ &lt; 1.2.<br /></p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<p><br />
9.3 本题要求利用M-H方法，从标准柯西分布生成随机变量。我选择用正态分布作为proposal distribution。<br /></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb57-2"><a href="#cb57-2"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x, theta, nita) {</span>
<span id="cb57-3"><a href="#cb57-3"></a>  <span class="kw">stopifnot</span>(theta <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb57-4"><a href="#cb57-4"></a>  <span class="kw">return</span>(<span class="dv">1</span><span class="op">/</span><span class="st"> </span>(theta<span class="op">*</span>pi<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>((x<span class="op">-</span>nita)<span class="op">/</span>theta)<span class="op">^</span><span class="dv">2</span>)))  <span class="co">#柯西分布的分布函数</span></span>
<span id="cb57-5"><a href="#cb57-5"></a>} </span>
<span id="cb57-6"><a href="#cb57-6"></a></span>
<span id="cb57-7"><a href="#cb57-7"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb57-8"><a href="#cb57-8"></a>theta &lt;-<span class="st"> </span><span class="dv">1</span>  </span>
<span id="cb57-9"><a href="#cb57-9"></a>nita &lt;-<span class="st"> </span><span class="dv">0</span> <span class="co">#设定标准柯西分布</span></span>
<span id="cb57-10"><a href="#cb57-10"></a>sigma &lt;-<span class="st"> </span><span class="fl">2.5</span></span>
<span id="cb57-11"><a href="#cb57-11"></a>x &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb57-12"><a href="#cb57-12"></a>x[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,sigma) <span class="co">#正态分布</span></span>
<span id="cb57-13"><a href="#cb57-13"></a>k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb57-14"><a href="#cb57-14"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(m)</span>
<span id="cb57-15"><a href="#cb57-15"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>m) {</span>
<span id="cb57-16"><a href="#cb57-16"></a>  xt &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb57-17"><a href="#cb57-17"></a>  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,xt,sigma)</span>
<span id="cb57-18"><a href="#cb57-18"></a>  num &lt;-<span class="st"> </span><span class="kw">f</span>(y, theta, nita) <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(xt, y, sigma)</span>
<span id="cb57-19"><a href="#cb57-19"></a>  den &lt;-<span class="st"> </span><span class="kw">f</span>(xt, theta, nita) <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(y, xt, sigma)</span>
<span id="cb57-20"><a href="#cb57-20"></a>  <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>num<span class="op">/</span>den) x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</span>
<span id="cb57-21"><a href="#cb57-21"></a>    x[i] &lt;-<span class="st"> </span>xt</span>
<span id="cb57-22"><a href="#cb57-22"></a>    k &lt;-<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span>  <span class="co">#拒绝次数</span></span>
<span id="cb57-23"><a href="#cb57-23"></a>  }</span>
<span id="cb57-24"><a href="#cb57-24"></a>}</span>
<span id="cb57-25"><a href="#cb57-25"></a><span class="kw">print</span>(k)</span>
<span id="cb57-26"><a href="#cb57-26"></a>index &lt;-<span class="st"> </span><span class="dv">5000</span><span class="op">:</span><span class="dv">5500</span></span>
<span id="cb57-27"><a href="#cb57-27"></a>y1 &lt;-<span class="st"> </span>x[index]</span>
<span id="cb57-28"><a href="#cb57-28"></a><span class="kw">plot</span>(index, y1, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>)</span>
<span id="cb57-29"><a href="#cb57-29"></a></span>
<span id="cb57-30"><a href="#cb57-30"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">1</span>, <span class="kw">seq</span>(.<span class="dv">2</span>, <span class="fl">.8</span>, <span class="fl">.1</span>), <span class="fl">.9</span>)</span>
<span id="cb57-31"><a href="#cb57-31"></a>Q &lt;-<span class="st"> </span><span class="kw">qt</span>(a, <span class="dv">1</span>)</span>
<span id="cb57-32"><a href="#cb57-32"></a>rw &lt;-<span class="st"> </span>x</span>
<span id="cb57-33"><a href="#cb57-33"></a>mc &lt;-<span class="st"> </span>rw[<span class="dv">1001</span><span class="op">:</span>m]</span>
<span id="cb57-34"><a href="#cb57-34"></a><span class="kw">print</span>(<span class="kw">round</span>(<span class="kw">cbind</span>(Q, <span class="dt">mc =</span><span class="kw">quantile</span>(x, a)),<span class="dv">3</span>))</span></code></pre></div>
<p>通过结果，可以发现，Q和mc还是比较相近的。<br /> 下面利用Gelman-Rubin method对chain进行监控，我先产生了4条chain，去除了前1000个，chain的长度取为20000，仍利用正态分布作为 proposal distribution。<br /></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {</span>
<span id="cb58-2"><a href="#cb58-2"></a>  psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)</span>
<span id="cb58-3"><a href="#cb58-3"></a>  n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</span>
<span id="cb58-4"><a href="#cb58-4"></a>  k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</span>
<span id="cb58-5"><a href="#cb58-5"></a>  </span>
<span id="cb58-6"><a href="#cb58-6"></a>  psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi)     </span>
<span id="cb58-7"><a href="#cb58-7"></a>  B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means)       </span>
<span id="cb58-8"><a href="#cb58-8"></a>  psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  </span>
<span id="cb58-9"><a href="#cb58-9"></a>  W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w)               </span>
<span id="cb58-10"><a href="#cb58-10"></a>  v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n)     </span>
<span id="cb58-11"><a href="#cb58-11"></a>  r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W             </span>
<span id="cb58-12"><a href="#cb58-12"></a>  <span class="kw">return</span>(r.hat)</span>
<span id="cb58-13"><a href="#cb58-13"></a>}</span>
<span id="cb58-14"><a href="#cb58-14"></a></span>
<span id="cb58-15"><a href="#cb58-15"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x, theta, nita) {</span>
<span id="cb58-16"><a href="#cb58-16"></a>  <span class="kw">stopifnot</span>(theta <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb58-17"><a href="#cb58-17"></a>  <span class="kw">return</span>(<span class="dv">1</span><span class="op">/</span><span class="st"> </span>(theta<span class="op">*</span>pi<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>((x<span class="op">-</span>nita)<span class="op">/</span>theta)<span class="op">^</span><span class="dv">2</span>)))  <span class="co">#柯西分布的分布函数</span></span>
<span id="cb58-18"><a href="#cb58-18"></a>} </span>
<span id="cb58-19"><a href="#cb58-19"></a></span>
<span id="cb58-20"><a href="#cb58-20"></a>normal.chain &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, N, X1) {</span>
<span id="cb58-21"><a href="#cb58-21"></a>  x &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb58-22"><a href="#cb58-22"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>X1</span>
<span id="cb58-23"><a href="#cb58-23"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb58-24"><a href="#cb58-24"></a>  </span>
<span id="cb58-25"><a href="#cb58-25"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb58-26"><a href="#cb58-26"></a>    xt &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb58-27"><a href="#cb58-27"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, xt, sigma)     <span class="co">#candidate point</span></span>
<span id="cb58-28"><a href="#cb58-28"></a>    r1 &lt;-<span class="st"> </span><span class="kw">f</span>(y, <span class="dv">1</span>, <span class="dv">0</span>) <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(xt, y, sigma)</span>
<span id="cb58-29"><a href="#cb58-29"></a>    r2 &lt;-<span class="st"> </span><span class="kw">f</span>(xt, <span class="dv">1</span>, <span class="dv">0</span>) <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(y, xt, sigma)</span>
<span id="cb58-30"><a href="#cb58-30"></a>    r &lt;-<span class="st"> </span>r1 <span class="op">/</span><span class="st"> </span>r2</span>
<span id="cb58-31"><a href="#cb58-31"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>r) x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span></span>
<span id="cb58-32"><a href="#cb58-32"></a>      x[i] &lt;-<span class="st"> </span>xt</span>
<span id="cb58-33"><a href="#cb58-33"></a>  }</span>
<span id="cb58-34"><a href="#cb58-34"></a>  <span class="kw">return</span>(x)</span>
<span id="cb58-35"><a href="#cb58-35"></a>}</span>
<span id="cb58-36"><a href="#cb58-36"></a></span>
<span id="cb58-37"><a href="#cb58-37"></a>sigma &lt;-<span class="st"> </span><span class="dv">1</span>    </span>
<span id="cb58-38"><a href="#cb58-38"></a>k &lt;-<span class="st"> </span><span class="dv">4</span>          </span>
<span id="cb58-39"><a href="#cb58-39"></a>n &lt;-<span class="st"> </span><span class="dv">20000</span>      </span>
<span id="cb58-40"><a href="#cb58-40"></a>b &lt;-<span class="st"> </span><span class="dv">1000</span>       </span>
<span id="cb58-41"><a href="#cb58-41"></a></span>
<span id="cb58-42"><a href="#cb58-42"></a>x0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">-5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb58-43"><a href="#cb58-43"></a></span>
<span id="cb58-44"><a href="#cb58-44"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb58-45"><a href="#cb58-45"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n)</span>
<span id="cb58-46"><a href="#cb58-46"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb58-47"><a href="#cb58-47"></a>  X[i, ] &lt;-<span class="st"> </span><span class="kw">normal.chain</span>(sigma, n, x0[i])</span>
<span id="cb58-48"><a href="#cb58-48"></a></span>
<span id="cb58-49"><a href="#cb58-49"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb58-50"><a href="#cb58-50"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb58-51"><a href="#cb58-51"></a>  psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb58-52"><a href="#cb58-52"></a></span>
<span id="cb58-53"><a href="#cb58-53"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb58-54"><a href="#cb58-54"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb58-55"><a href="#cb58-55"></a>  <span class="kw">plot</span>(psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb58-56"><a href="#cb58-56"></a>       <span class="dt">xlab=</span>i, <span class="dt">ylab=</span><span class="kw">bquote</span>(psi))</span>
<span id="cb58-57"><a href="#cb58-57"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) </span>
<span id="cb58-58"><a href="#cb58-58"></a></span>
<span id="cb58-59"><a href="#cb58-59"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb58-60"><a href="#cb58-60"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n)</span>
<span id="cb58-61"><a href="#cb58-61"></a>  rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb58-62"><a href="#cb58-62"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb58-63"><a href="#cb58-63"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><br />可以发现，chain会收敛到1.2以下。<br /></p>
<p><br />
9.8 本题要求利用Gibbs sampler方法生成chain。<br /> <span class="math inline">\(f(x,y) \propto \binom{n}{x}y^{x+a-1}(1-y)^{n-x+b-1}\)</span>， 由论文可知：<span class="math inline">\(f(x|y)\)</span> is <span class="math inline">\(binomial(n,y)\)</span>，<span class="math inline">\(f(y|x)\)</span> is <span class="math inline">\(Beta(x+a,n-x+b)\)</span>。</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a>N &lt;-<span class="st"> </span><span class="dv">5000</span> </span>
<span id="cb59-2"><a href="#cb59-2"></a>burn &lt;-<span class="st"> </span><span class="dv">1000</span> </span>
<span id="cb59-3"><a href="#cb59-3"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) </span>
<span id="cb59-4"><a href="#cb59-4"></a>a &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb59-5"><a href="#cb59-5"></a>b &lt;-<span class="st"> </span><span class="dv">4</span></span>
<span id="cb59-6"><a href="#cb59-6"></a>n &lt;-<span class="st"> </span><span class="dv">16</span></span>
<span id="cb59-7"><a href="#cb59-7"></a>m1 &lt;-<span class="st"> </span><span class="fl">0.5</span>  </span>
<span id="cb59-8"><a href="#cb59-8"></a>m2 &lt;-<span class="st"> </span><span class="fl">0.5</span></span>
<span id="cb59-9"><a href="#cb59-9"></a></span>
<span id="cb59-10"><a href="#cb59-10"></a>X[<span class="dv">1</span>, ] &lt;-<span class="st"> </span><span class="kw">c</span>(m1, m2) </span>
<span id="cb59-11"><a href="#cb59-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb59-12"><a href="#cb59-12"></a>  s &lt;-<span class="st"> </span>X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb59-13"><a href="#cb59-13"></a>  X[i, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1</span>, n, s)</span>
<span id="cb59-14"><a href="#cb59-14"></a>  t &lt;-<span class="st"> </span>X[i, <span class="dv">1</span>]</span>
<span id="cb59-15"><a href="#cb59-15"></a>  X[i, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">1</span>, t<span class="op">+</span>a, n<span class="op">-</span>t<span class="op">+</span>b)</span>
<span id="cb59-16"><a href="#cb59-16"></a>}</span>
<span id="cb59-17"><a href="#cb59-17"></a>b &lt;-<span class="st"> </span>burn <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb59-18"><a href="#cb59-18"></a>x &lt;-<span class="st"> </span>X[b<span class="op">:</span>N, ]</span>
<span id="cb59-19"><a href="#cb59-19"></a><span class="kw">plot</span>(x, <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">cex=</span>.<span class="dv">5</span>, <span class="dt">xlab=</span><span class="kw">bquote</span>(X[<span class="dv">1</span>]), <span class="dt">ylab=</span><span class="kw">bquote</span>(X[<span class="dv">2</span>]), <span class="dt">ylim=</span><span class="kw">range</span>(x[,<span class="dv">2</span>]))</span></code></pre></div>
<p><br />下面利用Gelman-Rubin method对chain进行监控。</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="kw">library</span>(stableGR)</span>
<span id="cb60-2"><a href="#cb60-2"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb60-3"><a href="#cb60-3"></a>gibbs.chain &lt;-<span class="st"> </span><span class="cf">function</span>(m1,m2,N,n,a,b) {</span>
<span id="cb60-4"><a href="#cb60-4"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)  </span>
<span id="cb60-5"><a href="#cb60-5"></a>X[<span class="dv">1</span>, ] &lt;-<span class="st"> </span><span class="kw">c</span>(m1, m2) </span>
<span id="cb60-6"><a href="#cb60-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb60-7"><a href="#cb60-7"></a>  s &lt;-<span class="st"> </span>X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb60-8"><a href="#cb60-8"></a>  X[i, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1</span>, n, s)</span>
<span id="cb60-9"><a href="#cb60-9"></a>  t &lt;-<span class="st"> </span>X[i, <span class="dv">1</span>]</span>
<span id="cb60-10"><a href="#cb60-10"></a>  X[i, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">1</span>, t<span class="op">+</span>a, n<span class="op">-</span>t<span class="op">+</span>b)</span>
<span id="cb60-11"><a href="#cb60-11"></a>} </span>
<span id="cb60-12"><a href="#cb60-12"></a><span class="kw">return</span>(X)</span>
<span id="cb60-13"><a href="#cb60-13"></a>}</span>
<span id="cb60-14"><a href="#cb60-14"></a>chain1 &lt;-<span class="st"> </span><span class="kw">gibbs.chain</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="dv">1000</span>,<span class="dv">16</span>,<span class="dv">2</span>,<span class="dv">4</span>)</span>
<span id="cb60-15"><a href="#cb60-15"></a>chain2 &lt;-<span class="st"> </span><span class="kw">gibbs.chain</span>(<span class="fl">0.2</span>,<span class="fl">0.7</span>,<span class="dv">1000</span>,<span class="dv">16</span>,<span class="dv">2</span>,<span class="dv">4</span>)</span>
<span id="cb60-16"><a href="#cb60-16"></a>chain3 &lt;-<span class="st"> </span><span class="kw">gibbs.chain</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="dv">1000</span>,<span class="dv">16</span>,<span class="dv">2</span>,<span class="dv">4</span>)</span>
<span id="cb60-17"><a href="#cb60-17"></a>chain4 &lt;-<span class="st"> </span><span class="kw">gibbs.chain</span>(<span class="fl">0.6</span>,<span class="fl">0.4</span>,<span class="dv">1000</span>,<span class="dv">16</span>,<span class="dv">2</span>,<span class="dv">4</span>)</span>
<span id="cb60-18"><a href="#cb60-18"></a>m&lt;-<span class="st"> </span><span class="kw">list</span>(chain1,chain2,chain3,chain4)</span>
<span id="cb60-19"><a href="#cb60-19"></a><span class="kw">stable.GR</span>(m,<span class="dt">mapping=</span><span class="st">&quot;maxeigen&quot;</span>)</span></code></pre></div>
<p>利用stable函数进行监控，得到的mpsrf就是我们要的<span class="math inline">\(\hat{R}\)</span>，可以发现其小于1.2。</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {</span>
<span id="cb61-2"><a href="#cb61-2"></a>  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb61-3"><a href="#cb61-3"></a>  <span class="co"># for chain in i-th row of X</span></span>
<span id="cb61-4"><a href="#cb61-4"></a>  psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)</span>
<span id="cb61-5"><a href="#cb61-5"></a>  n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</span>
<span id="cb61-6"><a href="#cb61-6"></a>  k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</span>
<span id="cb61-7"><a href="#cb61-7"></a>  </span>
<span id="cb61-8"><a href="#cb61-8"></a>  psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi)     <span class="co">#row means</span></span>
<span id="cb61-9"><a href="#cb61-9"></a>  B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means)        <span class="co">#between variance est.</span></span>
<span id="cb61-10"><a href="#cb61-10"></a>  psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span></span>
<span id="cb61-11"><a href="#cb61-11"></a>  W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w)               <span class="co">#within est.</span></span>
<span id="cb61-12"><a href="#cb61-12"></a>  v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n)     <span class="co">#upper variance est.</span></span>
<span id="cb61-13"><a href="#cb61-13"></a>  r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W             <span class="co">#G-R statistic</span></span>
<span id="cb61-14"><a href="#cb61-14"></a>  <span class="kw">return</span>(r.hat)</span>
<span id="cb61-15"><a href="#cb61-15"></a>}</span>
<span id="cb61-16"><a href="#cb61-16"></a></span>
<span id="cb61-17"><a href="#cb61-17"></a><span class="co"># 生成二元随机变量的Gibbs sampler</span></span>
<span id="cb61-18"><a href="#cb61-18"></a><span class="co"># X1为初始值</span></span>
<span id="cb61-19"><a href="#cb61-19"></a>Bivariate.Gibbs &lt;-<span class="st"> </span><span class="cf">function</span>(N, X1){</span>
<span id="cb61-20"><a href="#cb61-20"></a>  a &lt;-<span class="st"> </span>b &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb61-21"><a href="#cb61-21"></a>  X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb61-22"><a href="#cb61-22"></a>  X[<span class="dv">1</span>,] &lt;-<span class="st"> </span>X1    <span class="co">#初始值</span></span>
<span id="cb61-23"><a href="#cb61-23"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){</span>
<span id="cb61-24"><a href="#cb61-24"></a>    X2 &lt;-<span class="st">  </span>X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb61-25"><a href="#cb61-25"></a>    X[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1</span>,<span class="dv">25</span>,X2)</span>
<span id="cb61-26"><a href="#cb61-26"></a>    X1 &lt;-<span class="st"> </span>X[i,<span class="dv">1</span>]</span>
<span id="cb61-27"><a href="#cb61-27"></a>    X[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">1</span>,X1<span class="op">+</span>a,<span class="dv">25</span><span class="op">-</span>X1<span class="op">+</span>b)</span>
<span id="cb61-28"><a href="#cb61-28"></a>  }</span>
<span id="cb61-29"><a href="#cb61-29"></a>  <span class="kw">return</span>(X)</span>
<span id="cb61-30"><a href="#cb61-30"></a>}</span>
<span id="cb61-31"><a href="#cb61-31"></a></span>
<span id="cb61-32"><a href="#cb61-32"></a>k &lt;-<span class="st"> </span><span class="dv">4</span>          </span>
<span id="cb61-33"><a href="#cb61-33"></a>N &lt;-<span class="st"> </span><span class="dv">8000</span> </span>
<span id="cb61-34"><a href="#cb61-34"></a>b &lt;-<span class="st"> </span><span class="dv">1000</span>    <span class="co">#burn-in length</span></span>
<span id="cb61-35"><a href="#cb61-35"></a>X1 &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">7</span>,<span class="dv">10</span>,<span class="dv">15</span>),<span class="kw">runif</span>(<span class="dv">4</span>)) <span class="co">#初始值</span></span>
<span id="cb61-36"><a href="#cb61-36"></a></span>
<span id="cb61-37"><a href="#cb61-37"></a><span class="co">#生成4条样本，每个第一维的放在X中，第二维的放在Y中</span></span>
<span id="cb61-38"><a href="#cb61-38"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb61-39"><a href="#cb61-39"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>N)</span>
<span id="cb61-40"><a href="#cb61-40"></a>Y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>N)</span>
<span id="cb61-41"><a href="#cb61-41"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</span>
<span id="cb61-42"><a href="#cb61-42"></a>  BG &lt;-<span class="st"> </span><span class="kw">Bivariate.Gibbs</span>(N, X1[i,])</span>
<span id="cb61-43"><a href="#cb61-43"></a>  X[i, ] &lt;-<span class="st"> </span>BG[,<span class="dv">1</span>]</span>
<span id="cb61-44"><a href="#cb61-44"></a>  Y[i, ] &lt;-<span class="st"> </span>BG[,<span class="dv">2</span>]</span>
<span id="cb61-45"><a href="#cb61-45"></a>}</span>
<span id="cb61-46"><a href="#cb61-46"></a></span>
<span id="cb61-47"><a href="#cb61-47"></a><span class="co"># 先考虑第一维样本X</span></span>
<span id="cb61-48"><a href="#cb61-48"></a></span>
<span id="cb61-49"><a href="#cb61-49"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb61-50"><a href="#cb61-50"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb61-51"><a href="#cb61-51"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb61-52"><a href="#cb61-52"></a>  psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb61-53"><a href="#cb61-53"></a></span>
<span id="cb61-54"><a href="#cb61-54"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb61-55"><a href="#cb61-55"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb61-56"><a href="#cb61-56"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N)</span>
<span id="cb61-57"><a href="#cb61-57"></a>  rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb61-58"><a href="#cb61-58"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb61-59"><a href="#cb61-59"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb61-60"><a href="#cb61-60"></a></span>
<span id="cb61-61"><a href="#cb61-61"></a><span class="co"># 再考虑第二维样本Y</span></span>
<span id="cb61-62"><a href="#cb61-62"></a></span>
<span id="cb61-63"><a href="#cb61-63"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb61-64"><a href="#cb61-64"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(Y, <span class="dv">1</span>, cumsum))</span>
<span id="cb61-65"><a href="#cb61-65"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb61-66"><a href="#cb61-66"></a>  psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb61-67"><a href="#cb61-67"></a></span>
<span id="cb61-68"><a href="#cb61-68"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb61-69"><a href="#cb61-69"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb61-70"><a href="#cb61-70"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N)</span>
<span id="cb61-71"><a href="#cb61-71"></a>  rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb61-72"><a href="#cb61-72"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb61-73"><a href="#cb61-73"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
</div>
<div id="question-8" class="section level2">
<h2>Question</h2>
<p>A-21015-2021-11-18 1. Exercises 11.3 and 11.5 (pages 353-354, Statistical Computing with R) <br /> 2. I Suppose T1, . . . , Tn are i.i.d. samples drawn from the exponential distribution with expectation λ. Those values greater than τ are not observed due to right censorship, so that the observed values are Yi = TiI(Ti ≤ τ) + τI(Ti &gt; τ), i = 1, . . . , n. Suppose τ = 1 and the observed Yi values are as follows: 0.54, 0.48, 0.33, 0.43, 1.00, 1.00, 0.91, 1.00, 0.21, 0.85. Use the E-M algorithm to estimate λ, compare your result with the observed data MLE (note: Yi follows a mixture distribution).<br /></p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<p><br />
11.3 (a)题目要求我们计算出式子 <span class="math inline">\(g=\sum_{k=0}^{\infty} \frac{(-1)^k}{k!2^k} \frac{\left\| a \right\|^{2k+2}}{(2k+1)(2k+2)} \frac{\Gamma((d+1)/2) \Gamma(k+3/2)}{\Gamma(k+d/2+1)}\)</span>的第k项。<br /> 首先，对该式子取对数， <span class="math inline">\(log(g)=\sum_{k=0}^{\infty} log(-1)^{k}-log(k!2^k) + (2k+2)log(\left\| a \right\|)- log((2k+1)(2k+2))+log(\Gamma((d+1)/2)+log(\Gamma(k+3/2))-log(\Gamma(k+d/2+1))\)</span></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>k &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb62-2"><a href="#cb62-2"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb62-3"><a href="#cb62-3"></a>d &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb62-4"><a href="#cb62-4"></a>norm_vec &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">sqrt</span>(<span class="kw">sum</span>(x<span class="op">^</span><span class="dv">2</span>)) <span class="co">#计算向量欧几里得范数</span></span>
<span id="cb62-5"><a href="#cb62-5"></a>kth &lt;-<span class="st"> </span>(<span class="op">-</span><span class="dv">1</span>)<span class="op">^</span>k <span class="op">*</span><span class="st"> </span><span class="kw">norm_vec</span>(a)<span class="op">^</span>(<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="st"> </span><span class="kw">factorial</span>(k) <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span><span class="op">^</span>k) <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="kw">lgamma</span>((d<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">lgamma</span>(k<span class="op">+</span><span class="dv">3</span><span class="op">/</span><span class="dv">2</span>) <span class="op">-</span><span class="st"> </span><span class="kw">lgamma</span>(k<span class="op">+</span>d<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb62-6"><a href="#cb62-6"></a><span class="kw">print</span>(kth)</span></code></pre></div>
<pre><code>## [1] -0.09986854</code></pre>
<p><br /> 可以发现，该式子能计算出k和d不那么大时候kth的值。</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a>k &lt;-<span class="st"> </span><span class="dv">400</span></span>
<span id="cb64-2"><a href="#cb64-2"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb64-3"><a href="#cb64-3"></a>d &lt;-<span class="st"> </span><span class="dv">400</span></span>
<span id="cb64-4"><a href="#cb64-4"></a>norm_vec &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">sqrt</span>(<span class="kw">sum</span>(x<span class="op">^</span><span class="dv">2</span>)) <span class="co">#计算向量欧几里得范数</span></span>
<span id="cb64-5"><a href="#cb64-5"></a>kth &lt;-<span class="st"> </span>(<span class="op">-</span><span class="dv">1</span>)<span class="op">^</span>k <span class="op">*</span><span class="st"> </span><span class="kw">norm_vec</span>(a)<span class="op">^</span>(<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="kw">factorial</span>(k) <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span><span class="op">^</span>k) <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="kw">lgamma</span>((d<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">lgamma</span>(k<span class="op">+</span><span class="dv">3</span><span class="op">/</span><span class="dv">2</span>) <span class="op">-</span><span class="st"> </span><span class="kw">lgamma</span>(k<span class="op">+</span>d<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb64-6"><a href="#cb64-6"></a><span class="kw">print</span>(kth)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p><br /> 可以发现，当k和d都很大时，该式子收敛到0。</p>
<p><br /> (b)题目要求我们修改代码，计算出g的值。</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a>norm_vec &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">sqrt</span>(<span class="kw">sum</span>(x<span class="op">^</span><span class="dv">2</span>)) <span class="co">#计算向量欧几里得范数</span></span>
<span id="cb66-2"><a href="#cb66-2"></a>kth &lt;-<span class="st"> </span><span class="cf">function</span>(k,a,d){</span>
<span id="cb66-3"><a href="#cb66-3"></a>  (<span class="op">-</span><span class="dv">1</span>)<span class="op">^</span>k <span class="op">*</span><span class="st"> </span><span class="kw">norm_vec</span>(a)<span class="op">^</span>(<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="kw">factorial</span>(k) <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span><span class="op">^</span>k) <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="kw">lgamma</span>((d<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">lgamma</span>(k<span class="op">+</span><span class="dv">3</span><span class="op">/</span><span class="dv">2</span>) <span class="op">-</span><span class="st"> </span><span class="kw">lgamma</span>(k<span class="op">+</span>d<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb66-4"><a href="#cb66-4"></a>}</span>
<span id="cb66-5"><a href="#cb66-5"></a>sum &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb66-6"><a href="#cb66-6"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">200</span>){</span>
<span id="cb66-7"><a href="#cb66-7"></a>  a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb66-8"><a href="#cb66-8"></a>  d &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb66-9"><a href="#cb66-9"></a>  sum &lt;-<span class="st"> </span>sum <span class="op">+</span><span class="st"> </span><span class="kw">kth</span>(k,a,d)</span>
<span id="cb66-10"><a href="#cb66-10"></a>}</span>
<span id="cb66-11"><a href="#cb66-11"></a><span class="kw">print</span>(sum)</span></code></pre></div>
<pre><code>## [1] -4.246388</code></pre>
<p><br /> (c)题目要求我们计算出<span class="math inline">\(a=(1,2)^{T}\)</span>时候g的值。</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a>norm_vec &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">sqrt</span>(<span class="kw">sum</span>(x<span class="op">^</span><span class="dv">2</span>)) <span class="co">#计算向量欧几里得范数</span></span>
<span id="cb68-2"><a href="#cb68-2"></a>kth &lt;-<span class="st"> </span><span class="cf">function</span>(k,a,d){</span>
<span id="cb68-3"><a href="#cb68-3"></a>  (<span class="op">-</span><span class="dv">1</span>)<span class="op">^</span>k <span class="op">*</span><span class="st"> </span><span class="kw">norm_vec</span>(a)<span class="op">^</span>(<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="kw">factorial</span>(k) <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span><span class="op">^</span>k) <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="kw">lgamma</span>((d<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">lgamma</span>(k<span class="op">+</span><span class="dv">3</span><span class="op">/</span><span class="dv">2</span>) <span class="op">-</span><span class="st"> </span><span class="kw">lgamma</span>(k<span class="op">+</span>d<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb68-4"><a href="#cb68-4"></a>}</span>
<span id="cb68-5"><a href="#cb68-5"></a>sum &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb68-6"><a href="#cb68-6"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">400</span>){</span>
<span id="cb68-7"><a href="#cb68-7"></a>  a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb68-8"><a href="#cb68-8"></a>  d &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb68-9"><a href="#cb68-9"></a>  sum &lt;-<span class="st"> </span>sum <span class="op">+</span><span class="st"> </span><span class="kw">kth</span>(k,a,d)</span>
<span id="cb68-10"><a href="#cb68-10"></a>}</span>
<span id="cb68-11"><a href="#cb68-11"></a><span class="kw">print</span>(sum)</span></code></pre></div>
<pre><code>## [1] -0.4313314</code></pre>
<p><br />
11.5 题目要求我们解出方程的解: $ 2 <em>{0}^{c</em>{k-1}}(1+ )^{-k/2}du = 2  _{0}^{c_k}(1+ )^{-(k+1)/2}du<span class="math inline">\(， 其中\)</span>c_k=$。<br /></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a>fun &lt;-<span class="st"> </span><span class="cf">function</span>(a,k) {</span>
<span id="cb70-2"><a href="#cb70-2"></a>  g1 &lt;-<span class="st"> </span><span class="cf">function</span>(u) (<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>k)<span class="op">^</span>(<span class="op">-</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb70-3"><a href="#cb70-3"></a>  g2 &lt;-<span class="st"> </span><span class="kw">integrate</span>(g1,<span class="dv">0</span>,<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k)<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)))<span class="op">$</span>value</span>
<span id="cb70-4"><a href="#cb70-4"></a>  g &lt;-<span class="st">  </span><span class="dv">2</span><span class="op">*</span>g2 <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="kw">lgamma</span>((k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>) <span class="op">-</span><span class="st">  </span><span class="kw">lgamma</span>(k<span class="op">/</span><span class="dv">2</span>) <span class="op">-</span><span class="kw">log</span>(<span class="kw">sqrt</span>(pi<span class="op">*</span>k)))  <span class="co">#对gamma函数取对数</span></span>
<span id="cb70-5"><a href="#cb70-5"></a>}</span>
<span id="cb70-6"><a href="#cb70-6"></a></span>
<span id="cb70-7"><a href="#cb70-7"></a>out &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">25</span>)</span>
<span id="cb70-8"><a href="#cb70-8"></a>i &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb70-9"><a href="#cb70-9"></a> <span class="cf">for</span> (k <span class="cf">in</span> <span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>)){ <span class="co">#和11.4一样的范围</span></span>
<span id="cb70-10"><a href="#cb70-10"></a>  f &lt;-<span class="st"> </span><span class="cf">function</span>(a) <span class="kw">fun</span>(a,k<span class="dv">-1</span>)<span class="op">-</span><span class="kw">fun</span>(a,k)  <span class="co">#题目给定的方程</span></span>
<span id="cb70-11"><a href="#cb70-11"></a>  o &lt;-<span class="st"> </span><span class="kw">uniroot</span>(f ,<span class="kw">c</span>(<span class="fl">0.01</span>,<span class="kw">sqrt</span>(k)<span class="op">-</span><span class="fl">0.3</span>)) <span class="co">#对上下界进行一些限制</span></span>
<span id="cb70-12"><a href="#cb70-12"></a>  out[i] &lt;-<span class="st"> </span>o<span class="op">$</span>root</span>
<span id="cb70-13"><a href="#cb70-13"></a>  i &lt;-<span class="st"> </span>i<span class="op">+</span><span class="dv">1</span></span>
<span id="cb70-14"><a href="#cb70-14"></a>}</span>
<span id="cb70-15"><a href="#cb70-15"></a></span>
<span id="cb70-16"><a href="#cb70-16"></a>i &lt;-<span class="st"> </span><span class="dv">23</span></span>
<span id="cb70-17"><a href="#cb70-17"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="kw">c</span>(<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)){</span>
<span id="cb70-18"><a href="#cb70-18"></a>  f &lt;-<span class="st"> </span><span class="cf">function</span>(a) <span class="kw">fun</span>(a,k<span class="dv">-1</span>)<span class="op">-</span><span class="kw">fun</span>(a,k) </span>
<span id="cb70-19"><a href="#cb70-19"></a>  o &lt;-<span class="st"> </span><span class="kw">uniroot</span>(f ,<span class="kw">c</span>(<span class="fl">0.01</span>,<span class="dv">2</span>))</span>
<span id="cb70-20"><a href="#cb70-20"></a>  out[i] &lt;-<span class="st"> </span>o<span class="op">$</span>root</span>
<span id="cb70-21"><a href="#cb70-21"></a>  i &lt;-<span class="st"> </span>i<span class="op">+</span><span class="dv">1</span></span>
<span id="cb70-22"><a href="#cb70-22"></a>}</span>
<span id="cb70-23"><a href="#cb70-23"></a><span class="kw">print</span>(out)</span></code></pre></div>
<pre><code>##  [1] 1.492102 1.533555 1.562745 1.584441 1.601183 1.614512 1.625385 1.634415
##  [9] 1.642033 1.648545 1.654154 1.659071 1.663411 1.667284 1.670735 1.673821
## [17] 1.676622 1.679168 1.681491 1.683585 1.685540 1.687344 1.720606 1.729753
## [25] 1.730905</code></pre>
<p>根据去年11.4习题的答案，会发现他们的结果类似。</p>
<p><br />
2. I Suppose T1, . . . , Tn are i.i.d. samples drawn from the exponential distribution with expectation λ. Those values greater than τ are not observed due to right censorship, so that the observed values are Yi = TiI(Ti ≤ τ) + τI(Ti &gt; τ), i = 1, . . . , n. Suppose τ = 1 and the observed Yi values are as follows: 0.54, 0.48, 0.33, 0.43, 1.00, 1.00, 0.91, 1.00, 0.21, 0.85. Use the E-M algorithm to estimate λ, compare your result with the observed data MLE (note: Yi follows a mixture distribution).<br /> 下面推导EM算法收敛： 由observed data likelihood的MLE估计：<br /> <span class="math inline">\(L_1(\lambda|x_1,...,x_{10})=\prod_{i=1}^7 \lambda e^{-\lambda x_i} \prod_{i=1}^3 P(X&gt;1)= \lambda^7 e^{-\lambda \sum_{i=1}^7 x_i} e^{-3\lambda}\)</span>,<br /> <span class="math inline">\(logL_1(\lambda|x_1,...,x_{10})=7log\lambda -\lambda \sum_{i=1}^7 x_i-3\lambda\)</span>,<br /> 得到 <span class="math inline">\(\hat{\lambda}=\frac{7}{3 + \sum_{i=1}^7 x_i}\)</span>。<br /> 下面是complete data likelihood:<br /> <span class="math inline">\(L_2(\lambda|x_1,...,x_{10})=\prod_{i=1}^7 \lambda e^{-\lambda x_i} \prod_{i=1}^3\lambda e^{-\lambda y_i} = \lambda^{10} e^{-\lambda \sum_{i=1}^7 x_i+\lambda \sum_{i=1}^3 y_i}\)</span>,<br /> <span class="math inline">\(logL_2(\lambda|x_1,...,x_{10})=10log(\lambda) - ( \lambda \sum_{i=1}^7 x_i+\lambda \sum_{i=1}^3 y_i)\)</span>,<br /> 得到 <span class="math inline">\(\hat{\lambda}=\frac{10}{\sum_{i=1}^7 x_i+ \sum_{i=1}^3 y_i}\)</span>。<br /> 下面做EM算法，找到收敛的<span class="math inline">\(\hat{\lambda}\)</span>。<br /> E步：<br /> <span class="math inline">\(E_{\hat{\lambda}}[logL_2(\lambda|x_1,...,x_{10})]=10log(\lambda) - \lambda \sum_{i=1}^7 x_i - \lambda \sum_{i=1}^3 E_{\hat{\lambda}}(y_i|x_1,...,x_{10})\\ =10log(\lambda) - \lambda \sum_{i=1}^7 x_i - 3\lambda \frac{\int_{1}^{\infty} \lambda e^{-\lambda}ydy}{\int_{1}^{\infty} \lambda e^{-\lambda}dy}\\=10log(\lambda)- \lambda \sum_{i=1}^7 x_i-3\lambda \frac{\lambda_1+1}{\lambda_1}\)</span> M步：求导得到驻点，可以发现其收敛到：<span class="math inline">\(\hat{\lambda}=\frac{7}{3 + \sum_{i=1}^7 x_i}\)</span>。</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="co">#用MLE算到的结果</span></span>
<span id="cb72-2"><a href="#cb72-2"></a><span class="kw">library</span>(stats4)</span>
<span id="cb72-3"><a href="#cb72-3"></a>data &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb72-4"><a href="#cb72-4"></a>mlogl &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">lam=</span><span class="fl">0.5</span>) {</span>
<span id="cb72-5"><a href="#cb72-5"></a>  <span class="kw">return</span>(<span class="op">-</span>(<span class="dv">7</span><span class="op">*</span><span class="kw">log</span>(lam) <span class="op">-</span><span class="st"> </span>lam <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(data)))</span>
<span id="cb72-6"><a href="#cb72-6"></a>}</span>
<span id="cb72-7"><a href="#cb72-7"></a>fit &lt;-<span class="st"> </span><span class="kw">mle</span>(mlogl)<span class="op">@</span>coef</span>
<span id="cb72-8"><a href="#cb72-8"></a><span class="kw">print</span>(fit)</span></code></pre></div>
<pre><code>##      lam 
## 1.037038</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="co">#下面是EM算法得到的结果</span></span>
<span id="cb74-2"><a href="#cb74-2"></a>data &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb74-3"><a href="#cb74-3"></a>N &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb74-4"><a href="#cb74-4"></a>tol &lt;-<span class="st"> </span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.5</span></span>
<span id="cb74-5"><a href="#cb74-5"></a>l &lt;-<span class="st"> </span><span class="fl">0.5</span></span>
<span id="cb74-6"><a href="#cb74-6"></a>l.old &lt;-<span class="st"> </span>l <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb74-7"><a href="#cb74-7"></a></span>
<span id="cb74-8"><a href="#cb74-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</span>
<span id="cb74-9"><a href="#cb74-9"></a>  l &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">/</span>( <span class="dv">3</span><span class="op">/</span>l <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(data) )</span>
<span id="cb74-10"><a href="#cb74-10"></a>  <span class="cf">if</span> (<span class="kw">abs</span>(l <span class="op">-</span><span class="st"> </span>l.old)<span class="op">/</span>l.old <span class="op">&lt;</span><span class="st"> </span>tol) <span class="cf">break</span></span>
<span id="cb74-11"><a href="#cb74-11"></a>  l.old &lt;-<span class="st"> </span>l</span>
<span id="cb74-12"><a href="#cb74-12"></a>}</span>
<span id="cb74-13"><a href="#cb74-13"></a></span>
<span id="cb74-14"><a href="#cb74-14"></a><span class="kw">print</span>(<span class="kw">list</span>(<span class="dt">lambda =</span> l, <span class="dt">iter =</span> i, <span class="dt">tol =</span> tol))</span></code></pre></div>
<pre><code>## $lambda
## [1] 1.037037
## 
## $iter
## [1] 16
## 
## $tol
## [1] 1.490116e-08</code></pre>
<p>观察发现，两者很接近。</p>
</div>
<div id="question-9" class="section level2">
<h2>Question</h2>
<p>A-21015-2021-11-25 1. Exercises 1 and 5 (page 204, Advanced R) <br /> 2. Excecises 1 and 7 (page 214, Advanced R) <br /></p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<p><br />
1</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a>trims &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>)</span>
<span id="cb76-2"><a href="#cb76-2"></a>x &lt;-<span class="st"> </span><span class="kw">rcauchy</span>(<span class="dv">100</span>)</span>
<span id="cb76-3"><a href="#cb76-3"></a>m &lt;-<span class="st"> </span><span class="kw">lapply</span>(trims, <span class="cf">function</span>(trim) <span class="kw">mean</span>(x, <span class="dt">trim =</span> trim))</span>
<span id="cb76-4"><a href="#cb76-4"></a>n &lt;-<span class="st"> </span><span class="kw">lapply</span>(trims, mean, <span class="dt">x =</span> x)</span>
<span id="cb76-5"><a href="#cb76-5"></a><span class="kw">print</span>(m)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 1.07923
## 
## [[2]]
## [1] -0.01855338
## 
## [[3]]
## [1] -0.02602061
## 
## [[4]]
## [1] -0.06984272</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="kw">print</span>(n)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 1.07923
## 
## [[2]]
## [1] -0.01855338
## 
## [[3]]
## [1] -0.02602061
## 
## [[4]]
## [1] -0.06984272</code></pre>
<p>lapply函数的功能是：遍历列表向量内的每个元素，并且使用指定函数来对其元素进行处理。返回列表向量。在这道题中，m对trims中的每个元素都做了函数function，function的作用是求均值；而n对trims中每个元素都做了mean操作。<br /></p>
<p><br />
2 第三题：先拟合线性模型，然后利用rsq函数。</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(mpg <span class="op">~</span><span class="st"> </span>disp, mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp), mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt, mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt)</span>
<span id="cb80-2"><a href="#cb80-2"></a>l1 &lt;-<span class="st"> </span><span class="kw">lapply</span>(formulas, lm, mtcars)</span>
<span id="cb80-3"><a href="#cb80-3"></a>l2 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb80-4"><a href="#cb80-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(formulas)){</span>
<span id="cb80-5"><a href="#cb80-5"></a>  l2[[i]]&lt;-<span class="st"> </span><span class="kw">lm</span>(formulas[[i]],mtcars)</span>
<span id="cb80-6"><a href="#cb80-6"></a>}</span>
<span id="cb80-7"><a href="#cb80-7"></a>rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared</span>
<span id="cb80-8"><a href="#cb80-8"></a>r1 &lt;-<span class="st"> </span><span class="kw">lapply</span>(l1,rsq)</span>
<span id="cb80-9"><a href="#cb80-9"></a>r2 &lt;-<span class="st"> </span><span class="kw">lapply</span>(l2,rsq)</span>
<span id="cb80-10"><a href="#cb80-10"></a><span class="kw">print</span>(r1)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="kw">print</span>(r2)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<p>第四题：先对每个bootstrap的结果拟合模型mpg ~ disp，然后利用rsq函数。</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a>bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb84-2"><a href="#cb84-2"></a>  rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</span>
<span id="cb84-3"><a href="#cb84-3"></a>  mtcars[rows, ]</span>
<span id="cb84-4"><a href="#cb84-4"></a>})</span>
<span id="cb84-5"><a href="#cb84-5"></a>l1 &lt;-<span class="st"> </span><span class="kw">lapply</span>(bootstraps, lm, <span class="dt">formula=</span>mpg <span class="op">~</span><span class="st"> </span>disp)</span>
<span id="cb84-6"><a href="#cb84-6"></a>l2 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">10</span>))</span>
<span id="cb84-7"><a href="#cb84-7"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(bootstraps)){</span>
<span id="cb84-8"><a href="#cb84-8"></a>  l2[[i]]&lt;-<span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>disp,bootstraps[[i]])</span>
<span id="cb84-9"><a href="#cb84-9"></a>}</span>
<span id="cb84-10"><a href="#cb84-10"></a>rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared</span>
<span id="cb84-11"><a href="#cb84-11"></a>r1 &lt;-<span class="st"> </span><span class="kw">lapply</span>(l1,rsq)</span>
<span id="cb84-12"><a href="#cb84-12"></a>r2 &lt;-<span class="st"> </span><span class="kw">lapply</span>(l2,rsq)</span>
<span id="cb84-13"><a href="#cb84-13"></a><span class="kw">print</span>(r1)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.8527001
## 
## [[2]]
## [1] 0.6140887
## 
## [[3]]
## [1] 0.6854958
## 
## [[4]]
## [1] 0.7743867
## 
## [[5]]
## [1] 0.7930315
## 
## [[6]]
## [1] 0.818197
## 
## [[7]]
## [1] 0.7123044
## 
## [[8]]
## [1] 0.8274076
## 
## [[9]]
## [1] 0.7225731
## 
## [[10]]
## [1] 0.7484255</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a><span class="kw">print</span>(r2)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.8527001
## 
## [[2]]
## [1] 0.6140887
## 
## [[3]]
## [1] 0.6854958
## 
## [[4]]
## [1] 0.7743867
## 
## [[5]]
## [1] 0.7930315
## 
## [[6]]
## [1] 0.818197
## 
## [[7]]
## [1] 0.7123044
## 
## [[8]]
## [1] 0.8274076
## 
## [[9]]
## [1] 0.7225731
## 
## [[10]]
## [1] 0.7484255</code></pre>
<p><br />
3题目要我们<br /> (1)计算数据框中每列的标准偏差 <br /></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a><span class="kw">vapply</span>(mtcars, sd, <span class="kw">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##         mpg         cyl        disp          hp        drat          wt 
##   6.0269481   1.7859216 123.9386938  68.5628685   0.5346787   0.9784574 
##        qsec          vs          am        gear        carb 
##   1.7869432   0.5040161   0.4989909   0.7378041   1.6152000</code></pre>
<p><br /> (2)计算混合数据框中每数字列的标准偏差。 <br /></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a><span class="kw">vapply</span>(mtcars[<span class="kw">vapply</span>(mtcars,is.numeric,<span class="ot">TRUE</span>)], sd, <span class="kw">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##         mpg         cyl        disp          hp        drat          wt 
##   6.0269481   1.7859216 123.9386938  68.5628685   0.5346787   0.9784574 
##        qsec          vs          am        gear        carb 
##   1.7869432   0.5040161   0.4989909   0.7378041   1.6152000</code></pre>
<p><br />
4 mcsapply()是sapply()的多核版本。那么mcvapply()也是vapply()的多核版本吗？</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a><span class="co">#利用老师上课讲的代码计算sapply.</span></span>
<span id="cb92-2"><a href="#cb92-2"></a>start &lt;-<span class="st"> </span><span class="kw">Sys.time</span>()</span>
<span id="cb92-3"><a href="#cb92-3"></a>summary &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb92-4"><a href="#cb92-4"></a>  funs &lt;-<span class="st"> </span><span class="kw">c</span>(mean, median, sd, mad, IQR)</span>
<span id="cb92-5"><a href="#cb92-5"></a>  <span class="kw">sapply</span>(funs, <span class="cf">function</span>(f) <span class="kw">f</span>(x, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</span>
<span id="cb92-6"><a href="#cb92-6"></a>}</span>
<span id="cb92-7"><a href="#cb92-7"></a>end &lt;-<span class="st"> </span><span class="kw">Sys.time</span>()</span>
<span id="cb92-8"><a href="#cb92-8"></a><span class="kw">print</span>(end<span class="op">-</span>start)</span></code></pre></div>
<pre><code>## Time difference of 0 secs</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a><span class="co">#利用老师上课讲的代码计算parSapply.</span></span>
<span id="cb94-2"><a href="#cb94-2"></a><span class="kw">library</span>(parallel)</span>
<span id="cb94-3"><a href="#cb94-3"></a>start &lt;-<span class="st"> </span><span class="kw">Sys.time</span>()</span>
<span id="cb94-4"><a href="#cb94-4"></a>  cl.cores &lt;-<span class="st"> </span><span class="kw">detectCores</span>(<span class="dt">logical =</span> F) <span class="co">#计算电脑核心数</span></span>
<span id="cb94-5"><a href="#cb94-5"></a>  cl &lt;-<span class="st"> </span><span class="kw">makeCluster</span>(cl.cores) <span class="co"># 初始化要使用的核心数</span></span>
<span id="cb94-6"><a href="#cb94-6"></a>summary &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb94-7"><a href="#cb94-7"></a>  funs &lt;-<span class="st"> </span><span class="kw">c</span>(mean, median, sd, mad, IQR)</span>
<span id="cb94-8"><a href="#cb94-8"></a>  <span class="kw">parSapply</span>(cl,funs, <span class="cf">function</span>(f) <span class="kw">f</span>(x, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</span>
<span id="cb94-9"><a href="#cb94-9"></a>}</span>
<span id="cb94-10"><a href="#cb94-10"></a>end &lt;-<span class="st"> </span><span class="kw">Sys.time</span>()</span>
<span id="cb94-11"><a href="#cb94-11"></a><span class="kw">print</span>(end<span class="op">-</span>start)</span></code></pre></div>
<pre><code>## Time difference of 0.3942621 secs</code></pre>
<p>我认为mcvapply()不是vapply()的多核版本。</p>
</div>
<div id="question-10" class="section level2">
<h2>Question</h2>
<p>A-21015-2021-12-02 Write an Rcpp function for Exercise 9.8( page 278, Statistical Computing with R).<br />
</p>
<ul>
<li>Compare the corresponding generated random numbers with pure R language using the function “qqplot”.<br />
</li>
<li>Compare the computation time of the two functions with the function “microbenchmark”.<br />
</li>
<li>Comments your results.</li>
</ul>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a><span class="co">#include &lt;Rcpp.h&gt;</span></span>
<span id="cb96-2"><a href="#cb96-2"></a>using namespace Rcpp;</span>
<span id="cb96-3"><a href="#cb96-3"></a></span>
<span id="cb96-4"><a href="#cb96-4"></a><span class="op">/</span><span class="er">/</span><span class="st"> </span>[[Rcpp<span class="op">::</span>export]]</span>
<span id="cb96-5"><a href="#cb96-5"></a>NumericMatrix <span class="kw">gibbsC</span>(int N, int t) {</span>
<span id="cb96-6"><a href="#cb96-6"></a>  NumericMatrix <span class="kw">mat</span>(N, <span class="dv">2</span>);</span>
<span id="cb96-7"><a href="#cb96-7"></a>  double x =<span class="st"> </span><span class="dv">1</span>, y =<span class="st"> </span><span class="fl">0.5</span>;</span>
<span id="cb96-8"><a href="#cb96-8"></a>  <span class="cf">for</span>(int <span class="dt">i =</span> <span class="dv">0</span>; i <span class="op">&lt;</span><span class="st"> </span>N; i<span class="op">++</span>) {</span>
<span id="cb96-9"><a href="#cb96-9"></a>    <span class="cf">for</span>(int <span class="dt">j =</span> <span class="dv">0</span>; j <span class="op">&lt;</span><span class="st"> </span>t; j<span class="op">++</span>) {</span>
<span id="cb96-10"><a href="#cb96-10"></a>      x =<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1</span>, <span class="dv">2</span>, y)[<span class="dv">0</span>];</span>
<span id="cb96-11"><a href="#cb96-11"></a>      y =<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">1</span>, x <span class="op">+</span><span class="st"> </span><span class="dv">1</span>,  <span class="dv">2</span><span class="op">-</span>x<span class="op">+</span><span class="dv">1</span>)[<span class="dv">0</span>];</span>
<span id="cb96-12"><a href="#cb96-12"></a>    }</span>
<span id="cb96-13"><a href="#cb96-13"></a>    <span class="kw">mat</span>(i, <span class="dv">0</span>) =<span class="st"> </span>x;</span>
<span id="cb96-14"><a href="#cb96-14"></a>    <span class="kw">mat</span>(i, <span class="dv">1</span>) =<span class="st"> </span>y;</span>
<span id="cb96-15"><a href="#cb96-15"></a>  }</span>
<span id="cb96-16"><a href="#cb96-16"></a>  <span class="kw">return</span>(mat);</span>
<span id="cb96-17"><a href="#cb96-17"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a><span class="kw">library</span>(Rcpp)</span>
<span id="cb97-2"><a href="#cb97-2"></a>dir_cpp &lt;-<span class="st"> &#39;../Rcpp/&#39;</span></span>
<span id="cb97-3"><a href="#cb97-3"></a><span class="kw">sourceCpp</span>(<span class="kw">paste0</span>(dir_cpp,<span class="st">&quot;gibbsC.cpp&quot;</span>))</span></code></pre></div>
<p><strong>R language:</strong></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a>gibbsR &lt;-<span class="st"> </span><span class="cf">function</span>(N, thin){ <span class="co"># N is the length of chain</span></span>
<span id="cb98-2"><a href="#cb98-2"></a>  X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow =</span> N,<span class="dt">ncol =</span> <span class="dv">2</span>) <span class="co"># 样本阵</span></span>
<span id="cb98-3"><a href="#cb98-3"></a>  x &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb98-4"><a href="#cb98-4"></a>  y &lt;-<span class="st"> </span><span class="fl">0.5</span>    <span class="co"># 初始值</span></span>
<span id="cb98-5"><a href="#cb98-5"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){</span>
<span id="cb98-6"><a href="#cb98-6"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>thin){</span>
<span id="cb98-7"><a href="#cb98-7"></a>      x &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dt">prob =</span> y) <span class="co"># 更新x</span></span>
<span id="cb98-8"><a href="#cb98-8"></a>      y &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">1</span>,x<span class="op">+</span><span class="dv">1</span>,<span class="dv">2</span><span class="op">-</span>x<span class="op">+</span><span class="dv">1</span>)          <span class="co"># 更新y</span></span>
<span id="cb98-9"><a href="#cb98-9"></a>    }</span>
<span id="cb98-10"><a href="#cb98-10"></a>    X[i,] &lt;-<span class="st"> </span><span class="kw">c</span>(x,y)</span>
<span id="cb98-11"><a href="#cb98-11"></a>  }</span>
<span id="cb98-12"><a href="#cb98-12"></a>  <span class="kw">return</span>(X)</span>
<span id="cb98-13"><a href="#cb98-13"></a>}</span></code></pre></div>
<p><strong>qqplot:</strong></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a>gC &lt;-<span class="st"> </span><span class="kw">gibbsC</span>(<span class="dv">2000</span>,<span class="dv">10</span>)</span>
<span id="cb99-2"><a href="#cb99-2"></a>gR &lt;-<span class="st"> </span><span class="kw">gibbsR</span>(<span class="dv">2000</span>,<span class="dv">10</span>)</span>
<span id="cb99-3"><a href="#cb99-3"></a><span class="kw">qqplot</span>(gC[,<span class="dv">1</span>],gR[,<span class="dv">1</span>],<span class="dt">xlab=</span><span class="st">&quot; BiGibbsC-x&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot; BiGibbsR-x&quot;</span>)</span>
<span id="cb99-4"><a href="#cb99-4"></a><span class="kw">qqplot</span>(gC[,<span class="dv">2</span>],gR[,<span class="dv">2</span>],<span class="dt">xlab=</span><span class="st">&quot; BiGibbsC-y&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot; BiGibbsR-y&quot;</span>)</span></code></pre></div>
<p>可以看出用两种方法生成的结果比较相近。<br />
</p>
<p><strong>time:</strong></p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a><span class="kw">library</span>(microbenchmark)</span>
<span id="cb100-2"><a href="#cb100-2"></a>ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">gibbsR=</span><span class="kw">gibbsR</span>(<span class="dv">2000</span>,<span class="dv">10</span>),<span class="dt">gibbsC=</span><span class="kw">gibbsC</span>(<span class="dv">2000</span>,<span class="dv">10</span>))</span>
<span id="cb100-3"><a href="#cb100-3"></a><span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<p><strong>Comments:</strong> 通过QQ图的对比，gibbsR和gibbsC生成的数据非常接近，但是运行时间gibbsC要比gibbsR快很多</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
